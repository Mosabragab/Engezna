# Roadmap - Engezna Platform

## Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: 2026-02-21

## Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: MVP Ù…ÙƒØªÙ…Ù„ 100% - Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ¬Ù‡ÙŠØ² Ù„Ù€ Google Play Ùˆ App Store

---

## Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø±Ø§Ø­Ù„

| Ø§Ù„Ù…Ø±Ø­Ù„Ø©                                    | Ø§Ù„Ø­Ø§Ù„Ø©     | Ø§Ù„ØªÙ‚Ø¯Ù… |
| ------------------------------------------ | ---------- | ------ |
| Ø§Ù„Ù…Ø±Ø­Ù„Ø© 0: Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø£Ù…Ù†ÙŠØ© Ø¹Ø§Ø¬Ù„Ø©             | âœ… Ù…ÙƒØªÙ…Ù„   | 100%   |
| Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙˆØ§Ù„Ø£ØµÙˆØ§Øª         | âœ… Ù…ÙƒØªÙ…Ù„   | 100%   |
| Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1.5: Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø­Ø±Ø¬Ø© Ù…Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©      | âœ… Ù…ÙƒØªÙ…Ù„   | 100%   |
| Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡ (Lighthouse)       | ğŸ”„ Ø¬Ø§Ø±ÙŠ    | 75%    |
| Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: Ø¥Ø¹Ø¯Ø§Ø¯ Capacitor + Android Build | â¬œ Ù„Ù… ÙŠØ¨Ø¯Ø£ | 0%     |
| Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3B: Ø¥Ø¹Ø¯Ø§Ø¯ Capacitor + iOS Build    | â¬œ Ù„Ù… ÙŠØ¨Ø¯Ø£ | 0%     |
| Ø§Ù„Ù…Ø±Ø­Ù„Ø© 4: ØªØ¬Ù‡ÙŠØ² Google Play Store Listing | â¬œ Ù„Ù… ÙŠØ¨Ø¯Ø£ | 0%     |
| Ø§Ù„Ù…Ø±Ø­Ù„Ø© 4B: ØªØ¬Ù‡ÙŠØ² Apple App Store Listing  | â¬œ Ù„Ù… ÙŠØ¨Ø¯Ø£ | 0%     |
| Ø§Ù„Ù…Ø±Ø­Ù„Ø© 5: Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©     | â¬œ Ù„Ù… ÙŠØ¨Ø¯Ø£ | 0%     |
| Ø§Ù„Ù…Ø±Ø­Ù„Ø© 6: Ø§Ù„Ù†Ø´Ø± Ø¹Ù„Ù‰ Google Play           | â¬œ Ù„Ù… ÙŠØ¨Ø¯Ø£ | 0%     |
| Ø§Ù„Ù…Ø±Ø­Ù„Ø© 6B: Ø§Ù„Ù†Ø´Ø± Ø¹Ù„Ù‰ Apple App Store      | â¬œ Ù„Ù… ÙŠØ¨Ø¯Ø£ | 0%     |

---

## ğŸ”´ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø§Ù„Ø¢Ù†: Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2 + ØªÙ†Ø´ÙŠØ· Edge Functions

### Ù…Ù‡Ø§Ù… Edge Functions (Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ù‚ØµÙˆÙ‰ - Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„):

| #   | Ø§Ù„Ù…Ù‡Ù…Ø©                                                               | Ø§Ù„Ù†ÙˆØ¹    | Ø§Ù„Ø­Ø§Ù„Ø© |
| --- | -------------------------------------------------------------------- | -------- | ------ |
| 1   | Ù†Ø´Ø± `send-notification` Ùˆ `handle-notification-trigger` Ø¹Ù„Ù‰ Supabase | Supabase | â¬œ     |
| 2   | Ø¥Ø¹Ø¯Ø§Ø¯ `FIREBASE_SERVICE_ACCOUNT` ÙƒÙ€ Supabase Secret                  | Supabase | â¬œ     |
| 3   | Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©: trigger â†’ Edge Function â†’ FCM â†’ device        | Ø§Ø®ØªØ¨Ø§Ø±   | â¬œ     |
| 4   | Ø­Ø°Ù Database Webhooks Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ù…Ù† Supabase Dashboard                  | Supabase | â¬œ     |

### Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2 Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© (Ø£Ø¯Ø§Ø¡):

| #   | Ø§Ù„Ù…Ù‡Ù…Ø©                                 | Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© |
| --- | -------------------------------------- | -------- |
| 5   | Ø¶ØºØ· Ø§Ù„Ø¨Ø§Ù†Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (938KB â†’ < 200KB)   | Ø¹Ø§Ù„ÙŠ     |
| 6   | ØªØ­Ø³ÙŠÙ† Speed Index (ISR, streaming SSR) | Ù…ØªÙˆØ³Ø·    |
| 7   | ØªÙØ¹ÙŠÙ„ gzip/brotli compression          | Ù…ØªÙˆØ³Ø·    |
| 8   | ØªØ´ØºÙŠÙ„ Lighthouse audit ÙˆÙ…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ | Ù…ØªÙˆØ³Ø·    |

### ØªÙ… Ø¥Ù†Ø¬Ø§Ø²Ù‡ Ù…Ù† Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1.5 (2/13 - 2/14): âœ…

- âœ… Ø­Ø°Ù 7 triggers Ù…ÙƒØ´ÙˆÙØ© + Rotate Service Role Key + ØªØ­Ø¯ÙŠØ« ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ¦Ø§Øª
- âœ… triggers Ø§Ù„Ø¢Ù…Ù†Ø© (`on_*`) ØªØºØ·ÙŠ ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª (ØªØ£ÙƒÙŠØ¯ Ù…Ù† ÙØ­Øµ DB Ù…Ø¨Ø§Ø´Ø± 2/21)
- âœ… Ø¥ØµÙ„Ø§Ø­ Phantom Orders + Kashier Refund API + webhook idempotency
- âœ… ØªÙØ¹ÙŠÙ„ CSRF (enforce) + CSP (enforce) + RLS tightening
- âœ… ØªÙ†Ø¸ÙŠÙ console.log + Kashier webhook signature enforcement

---

## Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¬Ø§ÙŠØ© Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨

### Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2 + Edge Functions (2-3 Ø£ÙŠØ§Ù…)

- **Edge Functions (Ø£ÙˆÙ„ÙˆÙŠØ© Ù‚ØµÙˆÙ‰):**
  - Ù†Ø´Ø± `send-notification` + `handle-notification-trigger` Ø¹Ù„Ù‰ Supabase
  - Ø¥Ø¹Ø¯Ø§Ø¯ `FIREBASE_SERVICE_ACCOUNT` ÙƒÙ€ Supabase Secret
  - Ø­Ø°Ù Database Webhooks Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ù…Ù† Dashboard
  - Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©: trigger â†’ Edge Function â†’ FCM â†’ device
- **Ø£Ø¯Ø§Ø¡ (Ù…ØªØ¨Ù‚ÙŠ):**
  - Ø¶ØºØ· Ø§Ù„Ø¨Ø§Ù†Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (938KB â†’ < 200KB)
  - ØªØ­Ø³ÙŠÙ† Speed Index (ISR, streaming SSR)
  - Ø§Ù„Ù‡Ø¯Ù: Lighthouse Performance > 80

### Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3 + 3B - Capacitor + Android + iOS (4-6 Ø£ÙŠØ§Ù…)

- ØªØ«Ø¨ÙŠØª ÙˆØ¥Ø¹Ø¯Ø§Ø¯ Capacitor (Ù…Ø´ØªØ±Ùƒ)
- Ø¥Ø¹Ø¯Ø§Ø¯ Android project + native plugins + `google-services.json`
- Ø¥Ø¹Ø¯Ø§Ø¯ iOS project + Xcode + `GoogleService-Info.plist`
- APNs key setup + Firebase integration
- Ø§Ø®ØªØ¨Ø§Ø± Ø¹Ù„Ù‰ emulators ÙˆØ£Ø¬Ù‡Ø²Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ©
- Ø¨Ù†Ø§Ø¡ Release AAB (Android) + Archive (iOS)

### Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø§Ù„Ù…Ø±Ø­Ù„Ø© 4 + 4B - Store Listings (2-3 Ø£ÙŠØ§Ù…)

- ØªØ³Ø¬ÙŠÙ„ Ø­Ø³Ø§Ø¨ Google Play Developer ($25)
- ØªØ³Ø¬ÙŠÙ„ Ø­Ø³Ø§Ø¨ Apple Developer ($99/Ø³Ù†Ø©)
- ØªØµÙ…ÙŠÙ… Feature Graphic + Screenshots (PNG) Ù„ÙƒÙ„Ø§ Ø§Ù„Ù…ØªØ¬Ø±ÙŠÙ†
- ÙƒØªØ§Ø¨Ø© ÙˆØµÙ Ø§Ù„Ù…ØªØ¬Ø± (Ø¹Ø±Ø¨ÙŠ/Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ)
- Ù…Ù„Ø¡ Content Rating + Data Safety + App Privacy Labels
- Ø¥Ø¹Ø¯Ø§Ø¯ Sign in with Apple (Ø¥Ù„Ø²Ø§Ù…ÙŠ Ù„Ù€ App Store)

### Ø§Ù„Ø®Ø·ÙˆØ© 4: Ø§Ù„Ù…Ø±Ø­Ù„Ø© 5 - Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ (3-4 Ø£ÙŠØ§Ù…)

- ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Tests (Unit + Security + E2E)
- Ø§Ø®ØªØ¨Ø§Ø± ÙŠØ¯ÙˆÙŠ Ù„ÙƒÙ„ flow Ø¹Ù„Ù‰ Android Ùˆ iOS
- Lighthouse audit Ù†Ù‡Ø§Ø¦ÙŠ
- Ù…Ø±Ø§Ø¬Ø¹Ø© Ø£Ù…Ù†ÙŠØ© Ù†Ù‡Ø§Ø¦ÙŠØ©
- Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¹Ù„Ù‰ ÙƒÙ„Ø§ Ø§Ù„Ù†Ø¸Ø§Ù…ÙŠÙ†

### Ø§Ù„Ø®Ø·ÙˆØ© 5: Ø§Ù„Ù…Ø±Ø­Ù„Ø© 6 + 6B - Ø§Ù„Ù†Ø´Ø± (1-7 Ø£ÙŠØ§Ù…)

- **Android:** Internal Testing â†’ Closed Testing â†’ Production (Staged Rollout)
- **iOS:** TestFlight â†’ App Store Review â†’ Phased Release

---

## Ù†ØªØ§Ø¦Ø¬ ÙØ­Øµ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (2026-02-21)

> **Ø§Ù„Ù‡Ø¯Ù:** Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø³Ù„Ø§Ù…Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙˆØ§Ù„Ø£Ù…Ø§Ù† Ù‚Ø¨Ù„ Ù…Ø±Ø­Ù„Ø© Capacitor

### Triggers Ø§Ù„Ø¢Ù…Ù†Ø© âœ…

| Trigger                             | Table                    | Event        | Status  |
| ----------------------------------- | ------------------------ | ------------ | ------- |
| `on_customer_notification_fcm_sync` | `customer_notifications` | AFTER INSERT | âœ… ÙŠØ¹Ù…Ù„ |
| `on_provider_notification_fcm_sync` | `provider_notifications` | AFTER INSERT | âœ… ÙŠØ¹Ù…Ù„ |
| `on_admin_notification_fcm_sync`    | `admin_notifications`    | AFTER INSERT | âœ… ÙŠØ¹Ù…Ù„ |

### FCM Architecture âœ…

- `trigger_notification_fcm_sync()` â†’ `call_notification_webhook()` â†’ HTTP POST to Edge Function
- `fcm_tokens` table: ÙŠØ¯Ø¹Ù… `web`, `android`, `ios` device types
- Ø¢Ø®Ø± Ø¥Ø´Ø¹Ø§Ø±: 2026-02-19 (ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ)

### Cron Jobs (5/6 Ù†Ø´Ø·)

| Job                                  | Ø§Ù„Ø¬Ø¯ÙˆÙ„      | Ø§Ù„Ø­Ø§Ù„Ø©      |
| ------------------------------------ | ----------- | ----------- |
| `process_missing_embeddings`         | ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚  | âœ… Ù†Ø´Ø·      |
| `auto_confirm_expired_refunds`       | ÙƒÙ„ Ø³Ø§Ø¹Ø©     | âœ… Ù†Ø´Ø·      |
| `trigger_cleanup_custom_order_files` | Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹    | âœ… Ù†Ø´Ø·      |
| `expire_all_custom_orders`           | ÙƒÙ„ 30 Ø¯Ù‚ÙŠÙ‚Ø© | âœ… Ù†Ø´Ø·      |
| `expire_pending_payment_orders`      | ÙƒÙ„ 15 Ø¯Ù‚ÙŠÙ‚Ø© | âœ… Ù†Ø´Ø·      |
| `check_delayed_orders_and_notify`    | ÙƒÙ„ 30 Ø¯Ù‚ÙŠÙ‚Ø© | âš ï¸ **Ù…Ø¹Ø·Ù„** |

### Ù…ØªØ¨Ù‚ÙŠ

- [ ] Ù†Ø´Ø± Edge Functions
- [ ] Ø¥Ø¹Ø¯Ø§Ø¯ FIREBASE_SERVICE_ACCOUNT
- [ ] Ø­Ø°Ù Database Webhooks Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
- [ ] ØªÙØ¹ÙŠÙ„ cron job Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØªØ£Ø®Ø±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)

---

## Ù…Ø§ ØªÙ… Ø¥Ù†Ø¬Ø§Ø²Ù‡ Ø­Ø¯ÙŠØ«Ø§Ù‹ (ÙØ¨Ø±Ø§ÙŠØ± 2026)

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 0: Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø£Ù…Ù†ÙŠØ© âœ… (2/8)

- [x] Ù†Ù‚Ù„ Firebase credentials Ù„Ù€ dynamic injection
- [x] ØªØ­Ø¯ÙŠØ« jspdf v4.1.0 (Ø«ØºØ±Ø© Ø­Ø±Ø¬Ø©)
- [x] ØªØ¹Ø·ÙŠÙ„ test account auto-confirmation ÙÙŠ production
- [x] Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† RBAC middleware Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª âœ… (2/8 - 2/9)

- [x] Audio Manager Ù…Ø±ÙƒØ²ÙŠ (singleton) Ù…Ø¹ vibration fallback
- [x] Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù…Ù‚Ø¯Ù…ÙŠ Ø§Ù„Ø®Ø¯Ù…Ø§Øª (Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ØŒ Ø±Ø³Ø§Ù„Ø©ØŒ ØªÙ‚ÙŠÙŠÙ…ØŒ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ØŒ Ø´ÙƒÙˆÙ‰)
- [x] Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ØŒ Ø±Ø³Ø§Ù„Ø©ØŒ ØªØ³Ø¹ÙŠØ± Ù…Ø®ØµØµØŒ ØªØ°ÙƒØ±Ø© Ø¯Ø¹Ù…)
- [x] ØµÙØ­Ø© Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª (Ø¹Ù…ÙŠÙ„ + Ù…Ø²ÙˆØ¯ + Ø£Ø¯Ù…Ù†)
- [x] ØµÙØ­Ø© Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ù…Ù† `/admin/notifications`
- [x] Ø¥ØµÙ„Ø§Ø­ ØµÙˆØª Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„Ø¹Ù…ÙŠÙ„
- [x] Ø¥ØµÙ„Ø§Ø­ Ù†Ø¸Ø§Ù… Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø®Ø§ØµØ© (auto-archive, RLS, Ø£ØµÙ†Ø§Ù, Ø¥Ø´Ø¹Ø§Ø±Ø§Øª)
- [x] ØªÙ†Ø§Ø³Ù‚ ØªØµÙ…ÙŠÙ… ÙƒØ±ÙˆØª Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ù…Ø¹ Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1.5: Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø­Ø±Ø¬Ø© ğŸ”„ (2/12 - 2/13)

- [x] Ø­Ø°Ù 7 triggers ØªØ­ØªÙˆÙŠ Service Role JWT Ù…ÙƒØ´ÙˆÙ (2/13)
- [x] Ø¥ØµÙ„Ø§Ø­ Phantom Orders - Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨ Ù‚Ø¨Ù„ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù€ Kashier (2/13)
- [x] Ø¥Ù†Ø´Ø§Ø¡ Kashier Refund API endpoint (2/13)
- [x] Ø¥Ø¶Ø§ÙØ© webhook idempotency + unique constraint (2/13)
- [x] ØªÙØ¹ÙŠÙ„ CSRF protection ÙÙŠ middleware (log-only) (2/13)
- [x] Ø¥Ø²Ø§Ù„Ø© console.log ÙˆØ§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ø¨Ù€ structured logger (36 Ù…Ù„Ù) (2/13)
- [x] Ø¥Ù„Ø²Ø§Ù… Kashier webhook signature (2/13)
- [x] Ø¥ØµÙ„Ø§Ø­ promo validation identity spoofing (2/13)
- [x] Ø¥Ø¶Ø§ÙØ© CSP header (report-only) (2/13)
- [x] ØªØ¶ÙŠÙŠÙ‚ RLS policies Ø¹Ù„Ù‰ profiles, promo_codes, provider_invitations (2/13)
- [x] cron job Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© Ø¨Ø§Ù„Ø¯ÙØ¹ (pg_cron) (2/13)
- [x] Ø¥ØµÙ„Ø§Ø­ Kashier credentials validation (throw Ø¨Ø¯Ù„ fallback) (2/13)
- [x] Ù†Ù‚Ù„ cron Ù…Ù† Vercel Ù„Ù€ Supabase pg_cron (2/13)
- [x] Ø¹Ù…Ù„ Rotate Ù„Ù„Ù€ Service Role Key (2/13)
- [x] ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙØªØ§Ø­ ÙÙŠ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ¦Ø§Øª (2/13)
- [ ] Ø­Ø°Ù Database Webhooks Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© â† **Ù…Ø­ØªØ§Ø¬ Ø§Ù„Ù…Ø§Ù„Ùƒ**
- [x] ØªØ­ÙˆÙŠÙ„ CSRF Ù„Ù€ enforce mode (2/14)
- [x] ØªØ­ÙˆÙŠÙ„ CSP Ù„Ù€ enforce mode (2/14)
- [x] Ø¥Ø¶Ø§ÙØ© webhook handler Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ù…Ù† Kashier (2/14)
- [x] ØªØ£ÙƒÙŠØ¯ triggers Ø§Ù„Ø¢Ù…Ù†Ø© ØªØºØ·ÙŠ ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª (ÙØ­Øµ DB Ù…Ø¨Ø§Ø´Ø± 2/21)

### Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© (2/10 - 2/11)

- [x] Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø§Ù†Ø±Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„ØªØ±ÙˆÙŠØ¬ÙŠØ© (11 ØªØ­Ø³ÙŠÙ†)
- [x] Ø¥ØµÙ„Ø§Ø­ ÙÙ„ØªØ±Ø© Ø§Ù„Ù…ØªØ§Ø¬Ø± Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ
- [x] ØªØ­Ù…ÙŠÙ„ ÙØ¦Ø§Øª Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ØªØ±ÙˆÙŠØ¬ÙŠØ© Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹
- [x] ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØªØ§Ø¬Ø± Ù„Ù„Ø£Ø¯Ù…Ù†
- [x] Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†ÙƒÙŠØ© Ù„Ù„Ù…Ù†ØµØ© ÙˆØ§Ù„Ù…Ø²ÙˆØ¯ÙŠÙ†
- [x] Ø¥ØµÙ„Ø§Ø­ 9 Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø²ÙˆØ¯ÙŠÙ† (P0-P2)
- [x] Ø¥ØµÙ„Ø§Ø­ toggle switches ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª RTL

---

## High Priority (Before Launch)

### 1. Payment Integration (Kashier) âœ…

- [x] Kashier account setup and API credentials
- [x] Integrate Kashier Egyptian payment gateway
- [x] Online payment support for customers
- [x] Payment status webhooks
- [x] Payment result page
- [x] Webhook signature enforcement
- [x] Webhook idempotency (duplicate protection)
- [x] Phantom Orders fix (create before redirect)
- [x] Refund API endpoint
- [x] Pending payment timeout (pg_cron)
- [ ] Account activation (pending Kashier approval)

### 2. App Store Preparation â¬œ

- [ ] Generate app screenshots (PNG format - Arabic/English)
- [x] Write app store descriptions (docs/app-store/APP_STORE_METADATA.md)
- [ ] Complete Data Safety Form (Google) + App Privacy Labels (Apple)
- [x] Privacy Policy URL in manifest
- [ ] Test PWA installation on Android/iOS
- [ ] Design Feature Graphic (1024x500 px)
- [ ] Capacitor setup + Android + iOS build
- [x] Apple Review Notes prepared (docs/app-store/APPLE_REVIEW_NOTES.md)
- [ ] Sign in with Apple (Ø¥Ù„Ø²Ø§Ù…ÙŠ Ù„Ù€ App Store)

### 3. Testing & QA â¬œ

- [ ] Run existing E2E tests (Playwright)
- [ ] End-to-end user journey testing
- [ ] Payment flow testing
- [ ] Performance testing (Lighthouse > 80)
- [ ] Security tests

---

## Medium Priority

### 4. Push Notifications (Firebase) ğŸ”„

- [x] Firebase Cloud Messaging setup
- [x] Service worker integration (dynamic)
- [x] Notification preferences UI
- [x] Audio Manager with fallback
- [x] Database triggers for all events (3 Ø¢Ù…Ù†Ø©: customer/provider/admin)
- [x] `call_notification_webhook()` function (HTTP POST to Edge Function)
- [x] FCM tokens table with device_type support (web/android/ios)
- [ ] Ù†Ø´Ø± Edge Functions Ø¹Ù„Ù‰ Supabase (`send-notification` + `handle-notification-trigger`)
- [ ] Ø¥Ø¹Ø¯Ø§Ø¯ `FIREBASE_SERVICE_ACCOUNT` ÙƒÙ€ Supabase Secret
- [ ] Ø§Ø®ØªØ¨Ø§Ø± FCM Ø§Ù„Ø¯ÙˆØ±Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©: trigger â†’ Edge Function â†’ FCM â†’ device

### 5. Admin Promo Code UI âœ…

- [x] Promo code creation form
- [x] Manage existing promo codes
- [x] Track usage statistics
- [x] Expiration and usage limits
- [x] Dynamic category loading

### 6. Refund Handling âœ…

- [x] Refund request workflow
- [x] Admin approval process
- [x] Kashier Refund API endpoint
- [x] Refund notifications
- [x] Kashier refund webhook handler (ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø³ØªØ±Ø¬Ø§Ø¹) (2/14)

### 7. SMS Notifications â¬œ

- [ ] Twilio or local provider setup
- [ ] Order status SMS notifications
- [ ] OTP verification via SMS

---

## Low Priority (Post-Launch)

### 8. Advanced Analytics

- [ ] Time-series revenue/orders charts
- [ ] Performance metrics and trends
- [ ] Customer retention analytics

### 9. Banner System Enhancements âœ… (Ø£Ø³Ø§Ø³ÙŠ)

- [x] Banner management (CRUD)
- [x] Banner analytics (impressions, clicks)
- [x] Geo-targeted banners
- [ ] Video banner support
- [ ] A/B testing for banners

### 10. AI Assistant Improvements

- [ ] Claude 4.5 Haiku migration
- [ ] Improved product context tracking
- [ ] Multi-store support
- [ ] Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ù…Ø¹Ø·Ù„ Ù…Ø¤Ù‚ØªØ§Ù‹ (`NEXT_PUBLIC_AI_ASSISTANT_ENABLED=false`)

### 11. Code Quality (Post-Launch)

- [ ] ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© (8 Ù…Ù„ÙØ§Øª > 2000 Ø³Ø·Ø±)
- [ ] Ø¥ÙƒÙ…Ø§Ù„ Repository Pattern migration
- [ ] Supabase client singleton pattern

---

## Non-Technical Tasks (Before Launch)

- [ ] Restaurant onboarding (10 partners minimum)
- [ ] Marketing materials preparation
- [ ] Customer support training
- [x] Security audit (Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¹Ù…ÙŠÙ‚Ø© 2/12 + Ø¥ØµÙ„Ø§Ø­Ø§Øª 2/13)
- [x] Legal review (Terms & Privacy done)
- [ ] Google Play Developer account ($25)

---

## Completed Features

### Customer Side

- [x] Registration & authentication (Email + Google Native OAuth)
- [x] Provider browsing and search
- [x] Shopping cart and checkout
- [x] Order tracking and history
- [x] Favorites system
- [x] Real-time notifications (Realtime + polling fallback)
- [x] In-app chat with provider (read receipts âœ“/âœ“âœ“)
- [x] Product variants (size/weight)
- [x] Guest browsing (localStorage location)
- [x] Welcome/Landing page
- [x] PWA support (100/100 score)
- [x] Legal pages (Privacy, Terms)
- [x] Custom orders (triple broadcast)
- [x] Notification preferences
- [x] Refund requests

### Provider Side

- [x] Registration & approval flow
- [x] Dashboard with statistics
- [x] Order management (accept/reject/status updates)
- [x] Product management (CRUD)
- [x] Excel menu import
- [x] 4 pricing types (fixed, per_unit, variants, weight_variants)
- [x] Product variants
- [x] Provider categories
- [x] Finance page (COD/Online)
- [x] Real-time notifications
- [x] In-app chat
- [x] Delete account functionality
- [x] Notification preferences
- [x] Custom order cards (consistent design)
- [x] Bank details

### Admin Side

- [x] Dashboard and analytics
- [x] Provider approval system
- [x] Settlements management (COD/Online + auto-settlements)
- [x] Customer management (ban/unban)
- [x] Order management
- [x] Sidebar state persistence
- [x] Admin notifications page
- [x] Promo code management
- [x] Banner & promotions system
- [x] Products management page
- [x] Locations management (geo-targeting)
- [x] Refund management
- [x] Bank details for platform

### Security & Infrastructure

- [x] Upstash Redis rate limiting
- [x] XSS protection in exports
- [x] Zod validation on API routes
- [x] Error boundaries (global + locale + admin + provider)
- [x] SEO (robots.ts, sitemap.ts, generateMetadata)
- [x] Sentry error monitoring
- [x] Vercel Analytics + Speed Insights
- [x] Structured logger (replaced console.log)
- [x] CSP header (report-only)
- [x] CSRF protection (log-only)
- [x] RLS policy tightening
- [x] Kashier webhook signature enforcement
- [x] Payment idempotency
- [x] Pending payment timeout (pg_cron)

---

## Test Accounts

| Email              | Password | Role              |
| ------------------ | -------- | ----------------- |
| provider@test.com  | Test123! | Ø³ÙˆØ¨Ø± Ù…Ø§Ø±ÙƒØª Ø§Ù„Ù†Ø¬Ø§Ø­ |
| provider2@test.com | Test123! | Ø³Ù„Ø·Ø§Ù† Ø¨ÙŠØªØ²Ø§       |
| provider3@test.com | Test123! | Ù„Ø§ÙÙ†Ø¯Ø± ÙƒØ§ÙÙŠÙ‡      |
| provider4@test.com | Test123! | Ù…Ø·Ø¹Ù… Ø§Ù„ØµÙØ§        |
| customer@test.com  | Test123! | Customer          |
| admin@test.com     | Test123! | Admin             |

---

## Architecture Reference

### Tech Stack

- **Frontend**: Next.js 16 (App Router), TypeScript, Tailwind CSS
- **Backend**: Supabase (PostgreSQL, Auth, RLS)
- **State**: Zustand (cart)
- **UI**: shadcn/ui
- **i18n**: next-intl (Arabic/English)
- **Testing**: Playwright (E2E), 270+ unit tests, 76 security tests
- **Monitoring**: Sentry (errors), Vercel Analytics (performance)
- **Security**: Upstash Redis (rate limiting), CSRF, CSP
- **Payment**: Kashier (Egyptian gateway)
- **Notifications**: Firebase Cloud Messaging

### Key Files

- `src/app/[locale]/` - Locale-aware pages
- `src/components/` - Reusable components
- `src/hooks/` - Custom React hooks
- `src/lib/` - Utilities and API functions
- `src/lib/repositories/` - Data access layer
- `supabase/migrations/` - Database migrations
- `docs/APP_STORES_RELEASE_ROADMAP.md` - Ø®Ø·Ø© ØªÙØµÙŠÙ„ÙŠØ© Ù„Ù„Ù†Ø´Ø± Ø¹Ù„Ù‰ Google Play Ùˆ App Store

### Key Documents

| Ø§Ù„Ù…Ù„Ù                                | Ø§Ù„Ù…Ø­ØªÙˆÙ‰                                                      |
| ------------------------------------ | ------------------------------------------------------------ |
| `docs/APP_STORES_RELEASE_ROADMAP.md` | Ø®Ø·Ø© Ø§Ù„Ù†Ø´Ø± Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ© (Ø§Ù„Ù…Ø±Ø§Ø­Ù„ 0-6B) - Google Play + App Store |
| `docs/PRE_RELEASE_REVIEW_REPORT.md`  | ØªÙ‚Ø±ÙŠØ± Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ø§ Ù‚Ø¨Ù„ Ø§Ù„Ù†Ø´Ø±                                    |
| `docs/MASTER_IMPLEMENTATION_PLAN.md` | Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ø´Ø§Ù…Ù„Ø© (Ø§Ù„Ù…Ø±Ø§Ø­Ù„ 1-4)                            |
| `docs/QUALITY_LAYERS_ROADMAP.md`     | Ø®Ø±ÙŠØ·Ø© Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ø¬ÙˆØ¯Ø©                                           |

### Pricing Types

| Type              | Description          | Example            |
| ----------------- | -------------------- | ------------------ |
| `fixed`           | Single price         | Coffee - 25 EGP    |
| `per_unit`        | Price per unit       | Meat - 250 EGP/kg  |
| `variants`        | Size/option variants | Pizza S/M/L        |
| `weight_variants` | Weight variants      | Lamb 250g/500g/1kg |
