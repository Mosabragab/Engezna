# ğŸ¦ Ø®Ø·Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ Ù„Ù…Ù†ØµØ© Ø¥Ù†Ø¬Ø²Ù†Ø§
## Financial Settlement Engine Rebuild Plan

**Ø§Ù„ØªØ§Ø±ÙŠØ®**: 25 Ø¯ÙŠØ³Ù…Ø¨Ø± 2025
**Ø§Ù„Ø¥ØµØ¯Ø§Ø±**: 2.3
**Ø§Ù„Ø­Ø§Ù„Ø©**: Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ° - Ø§Ù„Ù…Ø±Ø§Ø­Ù„ 1-4 Ù…ÙƒØªÙ…Ù„Ø© âœ…

---

## ğŸš€ Ù…Ù„Ø®Øµ Ø§Ù„ØªÙ†ÙÙŠØ° (25 Ø¯ÙŠØ³Ù…Ø¨Ø± 2025)

### Ø§Ù„Ù…ÙƒØªÙ…Ù„ âœ…
| Ø§Ù„Ù…ÙŠØ²Ø© | Ø§Ù„Ù…Ù„Ù | Ø§Ù„Ø­Ø§Ù„Ø© |
|--------|-------|--------|
| Money class Ù„Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© | `src/lib/finance/money.ts` | âœ… |
| Financial Settlement Engine SQL View | `migrations/20251225100000_*.sql` | âœ… |
| FinancialService class | `src/lib/finance/financial-service.ts` | âœ… |
| Provider Finance Page (COD/Online breakdown) | `app/[locale]/provider/finance/page.tsx` | âœ… |
| Realtime subscriptions Ù„Ù„ØªØ§Ø¬Ø± | `provider/finance/page.tsx` | âœ… |
| PDF Export Ù„Ù„ØªØ³ÙˆÙŠØ§Øª | `src/lib/finance/export-service.ts` | âœ… |
| CSV Export Ù„Ù„ØªØ³ÙˆÙŠØ§Øª | `src/lib/finance/export-service.ts` | âœ… |
| Audit Trail Ù„Ù„ØªØ³ÙˆÙŠØ§Øª | `settlements/[id]/page.tsx` | âœ… |

### Ù‚ÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ ğŸ”„
- Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ØªØºÙŠÙŠØ± Ø§Ù„ØªØ³ÙˆÙŠØ© (toast notifications)
- ØªØ­Ø³ÙŠÙ† ØµÙØ­Ø© Analytics Ø§Ù„Ù…Ø§Ù„ÙŠØ©

---

## âš ï¸ Ù…Ø¨Ø¯Ø£ Ø£Ø³Ø§Ø³ÙŠ: Ø§Ù„ØªØ§Ø¬Ø± Ù‡Ùˆ Ø§Ù„Ù…ÙˆØµÙ‘Ù„

> **Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ = Ø­Ù‚ Ø£ØµÙŠÙ„ Ù„Ù„ØªØ§Ø¬Ø± (Ù„Ø§ ØªÙØ±Ø¯ Ø­ØªÙ‰ Ù…Ø¹ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª)**
>
> Ø§Ù„ØªØ§Ø¬Ø± ÙŠØ¯ÙŠØ± Ø§Ù„ØªÙˆØµÙŠÙ„ Ø¨Ù†ÙØ³Ù‡ØŒ Ù„Ø°Ø§ Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ Ù‡ÙŠ Ø¥ÙŠØ±Ø§Ø¯ Ù„Ù‡ ÙˆÙ„ÙŠØ³Øª Ù„Ù„Ù…Ù†ØµØ©.
> Ø¹Ù†Ø¯ Ø­Ø¯ÙˆØ« Ù…Ø±ØªØ¬Ø¹ØŒ Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ **Ù„Ø§ ØªÙØ±Ø¯** Ù„Ù„Ø¹Ù…ÙŠÙ„ Ù„Ø£Ù† Ø®Ø¯Ù…Ø© Ø§Ù„ØªÙˆØµÙŠÙ„ ØªÙ…Øª Ø¨Ø§Ù„ÙØ¹Ù„.

---

## ğŸ“‹ Ø§Ù„ÙÙ‡Ø±Ø³

1. [Ø§Ù„Ù…Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ](#1-Ø§Ù„Ù…Ø¨Ø¯Ø£-Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠ-Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ)
2. [Ù‡ÙŠÙƒÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­](#2-Ù‡ÙŠÙƒÙ„-Ù‚Ø§Ø¹Ø¯Ø©-Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª-Ø§Ù„Ù…Ù‚ØªØ±Ø­)
3. [Ø¥Ø¹Ø§Ø¯Ø© ØªØµÙ…ÙŠÙ… Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø§Ù„ØªØ§Ø¬Ø±](#3-Ø¥Ø¹Ø§Ø¯Ø©-ØªØµÙ…ÙŠÙ…-Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯-Ø§Ù„ØªØ§Ø¬Ø±)
4. [ØµÙØ­Ø© Ø§Ù„ØªØ³ÙˆÙŠØ§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©](#4-ØµÙØ­Ø©-Ø§Ù„ØªØ³ÙˆÙŠØ§Øª-Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©)
5. [Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©](#5-Ù„ÙˆØ­Ø©-ØªØ­ÙƒÙ…-Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©-Ø§Ù„Ù…Ø§Ù„ÙŠØ©)
6. [Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ø±Ø­Ù„ÙŠØ©](#6-Ø®Ø·Ø©-Ø§Ù„ØªÙ†ÙÙŠØ°-Ø§Ù„Ù…Ø±Ø­Ù„ÙŠØ©)
7. [Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±](#7-Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª-Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±)
8. [ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØ³ÙˆÙŠØ© PDF](#8-ØªÙ‚Ø±ÙŠØ±-Ø§Ù„ØªØ³ÙˆÙŠØ©-pdf)
9. [Ù…Ø¹Ø§ÙŠÙŠØ± Ù†Ø¬Ø§Ø­ Ø§Ù„ØªÙ†ÙÙŠØ°](#9-Ù…Ø¹Ø§ÙŠÙŠØ±-Ù†Ø¬Ø§Ø­-Ø§Ù„ØªÙ†ÙÙŠØ°)
10. [Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©](#10-Ù…Ù„Ø§Ø­Ø¸Ø§Øª-Ù…Ù‡Ù…Ø©)

---

## 1. Ø§Ù„Ù…Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ

### ğŸ¯ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø¬ÙˆÙ‡Ø±ÙŠ: "Ø£ÙŠÙ† ØªÙˆØ¬Ø¯ Ø§Ù„ÙƒØ§Ø´ Ø§Ù„Ø¢Ù†ØŸ"

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ØªØ¯ÙÙ‚ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ ÙÙŠ Ø¥Ù†Ø¬Ø²Ù†Ø§                           â”‚
â”‚                    (Ø§Ù„ØªØ§Ø¬Ø± Ù‡Ùˆ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„ØªÙˆØµÙŠÙ„)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ’µ COD (Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…)          ğŸ’³ Online (Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ)     â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚                                                                         â”‚
â”‚   Ø§Ù„Ø¹Ù…ÙŠÙ„ â”€â”€ğŸ’µâ”€â”€â–º Ø§Ù„ØªØ§Ø¬Ø±                Ø§Ù„Ø¹Ù…ÙŠÙ„ â”€â”€ğŸ’³â”€â”€â–º Ø§Ù„Ù…Ù†ØµØ©            â”‚
â”‚        (Ø§Ù„Ù…Ù†ØªØ¬ + Ø§Ù„ØªÙˆØµÙŠÙ„)                   (Ø§Ù„Ù…Ù†ØªØ¬ + Ø§Ù„ØªÙˆØµÙŠÙ„)          â”‚
â”‚                    â”‚                                      â”‚             â”‚
â”‚                    â”‚                                      â”‚             â”‚
â”‚            Ø§Ù„ØªØ§Ø¬Ø± ÙŠØ¯ÙŠÙ†                            Ø§Ù„Ù…Ù†ØµØ© ØªØ¯ÙŠÙ†           â”‚
â”‚            Ù„Ù„Ù…Ù†ØµØ© Ø¨Ù€:                             Ù„Ù„ØªØ§Ø¬Ø± Ø¨Ù€:            â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚            â”‚ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©  â”‚                          â”‚ ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª   â”‚   â”‚
â”‚            â”‚ (7% max) â”‚                          â”‚ - Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©       â”‚   â”‚
â”‚            â”‚  ÙÙ‚Ø·!    â”‚                          â”‚ + Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„  â”‚   â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚   (Ø­Ù‚ Ø§Ù„ØªØ§Ø¬Ø±)   â”‚   â”‚
â”‚                                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“ Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ = Ø­Ù‚ Ø§Ù„ØªØ§Ø¬Ø± (Ù„Ø£Ù†Ù‡ Ù‡Ùˆ Ø§Ù„Ù…ÙˆØµÙ‘Ù„)                         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

#### Ø­Ø§Ù„Ø© COD:
```
Ø§Ù„ØªØ§Ø¬Ø± Ø§Ø³ØªÙ„Ù… = subtotal + delivery_fee - discount (ÙƒÙ„ Ø´ÙŠØ¡!)
ØµØ§ÙÙŠ Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„ØªØ§Ø¬Ø± = subtotal - discount (ÙˆØ¹Ø§Ø¡ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©)
Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø© Ù„Ù„Ù…Ù†ØµØ© = ØµØ§ÙÙŠ Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„ØªØ§Ø¬Ø± Ã— Ù†Ø³Ø¨Ø©_Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©

âœ… Ø§Ù„ÙƒØ§Ø´ Ù…Ø¹ Ø§Ù„ØªØ§Ø¬Ø± = subtotal + delivery_fee - discount
âœ… Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© Ø§Ù„ØªØ§Ø¬Ø± Ù„Ù„Ù…Ù†ØµØ© = Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ÙÙ‚Ø· (Ø¨Ø¯ÙˆÙ† Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„!)
```

#### Ø­Ø§Ù„Ø© Online:
```
Ø§Ù„Ù…Ù†ØµØ© Ø§Ø³ØªÙ„Ù…Øª = subtotal + delivery_fee - discount (ÙƒÙ„ Ø´ÙŠØ¡!)
ØµØ§ÙÙŠ Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„ØªØ§Ø¬Ø± = subtotal - discount (ÙˆØ¹Ø§Ø¡ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©)
Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø© Ù„Ù„Ù…Ù†ØµØ© = ØµØ§ÙÙŠ Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„ØªØ§Ø¬Ø± Ã— Ù†Ø³Ø¨Ø©_Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©

âœ… Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„ØªØ§Ø¬Ø± = (ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª - Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©) + Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„
                  = ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª - Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© + delivery_fee
```

#### ğŸ“Š Ø¬Ø¯ÙˆÙ„ ØªÙˆØ¶ÙŠØ­ÙŠ:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ø§Ù„Ø¨Ù†Ø¯                    â”‚ Ø®Ø§Ø¶Ø¹ Ù„Ù„Ø¹Ù…ÙˆÙ„Ø©ØŸ â”‚ Ù„Ù…Ù† ÙŠÙ†ØªÙ…ÙŠØŸ                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª          â”‚      âœ…       â”‚ Ø§Ù„ØªØ§Ø¬Ø± (Ø¨Ø¹Ø¯ Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©)    â”‚
â”‚  Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„             â”‚      âŒ       â”‚ Ø§Ù„ØªØ§Ø¬Ø± 100% (Ù‡Ùˆ Ø§Ù„Ù…ÙˆØµÙ‘Ù„)    â”‚
â”‚  Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª/Ø§Ù„Ø¹Ø±ÙˆØ¶          â”‚      âœ…       â”‚ ØªÙØ®ØµÙ… Ù…Ù† ÙˆØ¹Ø§Ø¡ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©       â”‚
â”‚  Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© (7% max)         â”‚      -        â”‚ Ø§Ù„Ù…Ù†ØµØ©                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª

> âš ï¸ **Ù‚Ø§Ø¹Ø¯Ø© Ø°Ù‡Ø¨ÙŠØ©**: Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ **Ù„Ø§ ØªÙØ±Ø¯** Ù„Ù„Ø¹Ù…ÙŠÙ„ Ù„Ø£Ù† Ø®Ø¯Ù…Ø© Ø§Ù„ØªÙˆØµÙŠÙ„ ØªÙ…Øª Ø¨Ø§Ù„ÙØ¹Ù„.
> Ø§Ù„Ù…Ø±ØªØ¬Ø¹ ÙŠÙØ·Ø¨Ù‚ Ø¹Ù„Ù‰ **Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙ‚Ø·**.

#### Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù„Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª:
```
âŒ Ø®Ø·Ø£: ((net_sales - commission) + delivery_fee) * (1 - refund_percentage)
âœ… ØµØ­ÙŠØ­: ((net_sales - commission) * (1 - refund_percentage)) + delivery_fee

Ø§Ù„ÙØ±Ù‚: Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ Ø«Ø§Ø¨ØªØ© ÙˆÙ„Ø§ ØªØªØ£Ø«Ø± Ø¨Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹
```

#### COD + Refund:
```
1. Ø§Ù„ØªØ§Ø¬Ø± ÙŠØ±Ø¯ Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ù„Ø¹Ù…ÙŠÙ„ (Ø¨Ø¯ÙˆÙ† Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„)
2. Ø§Ù„Ù…Ù†ØµØ© ØªØ±Ø¯ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø¨Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹
3. Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ ØªØ¨Ù‚Ù‰ Ù…Ø¹ Ø§Ù„ØªØ§Ø¬Ø± (Ù„Ø£Ù† Ø§Ù„Ø®Ø¯Ù…Ø© ØªÙ…Øª)
4. Ø§Ù„Ù‚ÙŠØ¯: ØªÙ‚Ù„ÙŠÙ„ Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© Ø§Ù„ØªØ§Ø¬Ø± Ø¨Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹ Ù…Ù† Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ÙÙ‚Ø·
```

#### Online + Refund:
```
1. Ø§Ù„Ù…Ù†ØµØ© ØªØ±Ø¯ Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Ù‹ Ù„Ù„Ø¹Ù…ÙŠÙ„ (Ø¨Ø¯ÙˆÙ† Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„)
2. ÙŠÙØ¹Ø¯ÙÙ‘Ù„ Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ§Ø¬Ø±:
   - ØªÙØ®ÙÙÙ‘Ø¶ Ù…Ø³ØªØ­Ù‚Ø§ØªÙ‡ Ù…Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹
   - ØªØ¨Ù‚Ù‰ Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ ÙƒØ§Ù…Ù„Ø© (Ù„Ø£Ù† Ø§Ù„Ø®Ø¯Ù…Ø© ØªÙ…Øª)
3. Ø§Ù„Ù‚ÙŠØ¯: ØªÙ‚Ù„ÙŠÙ„ Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„ØªØ§Ø¬Ø± Ù…Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙ‚Ø·

Ù…Ø«Ø§Ù„: Ø·Ù„Ø¨ 200 Ø¬ (Ù…Ù†ØªØ¬) + 20 Ø¬ (ØªÙˆØµÙŠÙ„) = 220 Ø¬
Ù…Ø±ØªØ¬Ø¹ 100%: Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙŠØ³ØªØ±Ø¯ 200 Ø¬ ÙÙ‚Ø·
Ø§Ù„ØªØ§Ø¬Ø± ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰: 20 Ø¬ (Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„) âœ…
```

#### Partial Refund (Ø§Ù„Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ø¬Ø²Ø¦ÙŠ):
```
Ù…Ø«Ø§Ù„: Ø·Ù„Ø¨ Ù‚Ù…ÙŠØµÙŠÙ† Ø¨Ù€ 500 Ø¬.Ù… + 30 Ø¬ ØªÙˆØµÙŠÙ„
Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø±Ø¬Ù‘Ø¹ Ù‚Ù…ÙŠØµ ÙˆØ§Ø­Ø¯ (250 Ø¬)
Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹ = 250 / 500 = 50%

Ø§Ù„Ø­Ø³Ø§Ø¨:
- Ù…Ø¨ÙŠØ¹Ø§Øª ØµØ§ÙÙŠØ©: 500 Ø¬
- Ø§Ù„Ù…Ø±ØªØ¬Ø¹: 250 Ø¬ (50%)
- ÙˆØ¹Ø§Ø¡ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø±ØªØ¬Ø¹: 250 Ø¬
- Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© (7%): 17.5 Ø¬
- Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„ØªØ§Ø¬Ø±: (250 - 17.5) + 30 = 262.5 Ø¬ âœ…
```

---

## 2. Ù‡ÙŠÙƒÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­

### 2.1 Ø§Ù„Ù€ View Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: `financial_settlement_engine`

```sql
-- Migration: 20251225_financial_settlement_engine.sql

CREATE OR REPLACE VIEW financial_settlement_engine AS
WITH order_financials AS (
    SELECT
        o.id AS order_id,
        o.provider_id,
        o.payment_method,
        o.status AS order_status,
        o.created_at AS order_date,

        -- Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        COALESCE(o.subtotal, o.total - COALESCE(o.delivery_fee, 0)) AS subtotal,
        COALESCE(o.delivery_fee, 0) AS delivery_fee,
        COALESCE(o.discount, 0) AS discount,
        o.total AS order_total,

        -- Ø­Ø³Ø§Ø¨ ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª (Ø¨Ø¯ÙˆÙ† Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„)
        (COALESCE(o.subtotal, o.total - COALESCE(o.delivery_fee, 0)) - COALESCE(o.discount, 0)) AS net_sales,

        -- Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©
        COALESCE(o.platform_commission, 0) AS applied_commission,
        COALESCE(o.original_commission, o.platform_commission, 0) AS theoretical_commission,

        -- Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª
        COALESCE(r.total_refund, 0) AS refund_amount,
        COALESCE(r.refund_confirmed, FALSE) AS refund_confirmed,

        -- Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹
        CASE
            WHEN o.total > 0 AND r.total_refund > 0
            THEN (r.total_refund::NUMERIC / o.total::NUMERIC)
            ELSE 0
        END AS refund_percentage,

        -- ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­
        p.commission_status,
        p.grace_period_end

    FROM orders o
    LEFT JOIN providers p ON o.provider_id = p.id
    LEFT JOIN (
        SELECT
            order_id,
            SUM(CASE WHEN customer_confirmed = TRUE THEN COALESCE(processed_amount, amount) ELSE 0 END) AS total_refund,
            BOOL_OR(customer_confirmed) AS refund_confirmed
        FROM refunds
        WHERE status IN ('approved', 'processed')
        GROUP BY order_id
    ) r ON o.id = r.order_id
    WHERE o.status = 'delivered'
),

-- ØªØµÙ†ÙŠÙ Ø§Ù„ØªØ¯ÙÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠ
cash_flow_classified AS (
    SELECT
        *,

        -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        -- ğŸ’µ COD: Ø§Ù„ØªØ§Ø¬Ø± Ø§Ø³ØªÙ„Ù… Ø§Ù„ÙƒØ§Ø´
        -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        CASE WHEN payment_method = 'cash' THEN
            order_total - refund_amount  -- Ø§Ù„ÙƒØ§Ø´ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ø¹ Ø§Ù„ØªØ§Ø¬Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª
        ELSE 0 END AS cash_in_hand_merchant,

        -- Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø© Ù„Ù„Ù…Ù†ØµØ© Ù…Ù† Ø·Ù„Ø¨Ø§Øª COD
        CASE WHEN payment_method = 'cash' THEN
            applied_commission * (1 - refund_percentage)  -- ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø¨Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹
        ELSE 0 END AS platform_receivables_from_cod,

        -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        -- ğŸ’³ Online: Ø§Ù„Ù…Ù†ØµØ© Ø§Ø³ØªÙ„Ù…Øª Ø§Ù„ÙƒØ§Ø´
        -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        CASE WHEN payment_method = 'online' THEN
            order_total - refund_amount  -- Ø§Ù„ÙƒØ§Ø´ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ø¹ Ø§Ù„Ù…Ù†ØµØ© Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª
        ELSE 0 END AS cash_held_by_platform,

        -- Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„ØªØ§Ø¬Ø± Ù…Ù† Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†
        -- âš ï¸ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ Ù„Ø§ ØªØªØ£Ø«Ø± Ø¨Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹!
        CASE WHEN payment_method = 'online' THEN
            ((net_sales - applied_commission) * (1 - refund_percentage)) + delivery_fee
            -- â¬†ï¸ delivery_fee Ø«Ø§Ø¨ØªØ© Ù„Ø£Ù† Ø®Ø¯Ù…Ø© Ø§Ù„ØªÙˆØµÙŠÙ„ ØªÙ…Øª
        ELSE 0 END AS merchant_receivables_from_online,

        -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        -- ğŸ“Š Ø§Ù„Ø®Ù„Ø§ØµØ©: Ø§Ù„Ù…ÙŠØ²Ø§Ù† Ø§Ù„ØµØ§ÙÙŠ
        -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        -- Ù…ÙˆØ¬Ø¨ = Ø§Ù„Ù…Ù†ØµØ© ØªØ¯ÙØ¹ Ù„Ù„ØªØ§Ø¬Ø±
        -- Ø³Ø§Ù„Ø¨ = Ø§Ù„ØªØ§Ø¬Ø± ÙŠØ¯ÙØ¹ Ù„Ù„Ù…Ù†ØµØ©
        CASE
            WHEN payment_method = 'online' THEN
                -- Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„ØªØ§Ø¬Ø± = (ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª - Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©) Ã— (1 - Ù†Ø³Ø¨Ø©_Ø§Ù„Ù…Ø±ØªØ¬Ø¹) + Ø±Ø³ÙˆÙ…_Ø§Ù„ØªÙˆØµÙŠÙ„
                ((net_sales - applied_commission) * (1 - refund_percentage)) + delivery_fee
            WHEN payment_method = 'cash' THEN
                -- Ø§Ù„ØªØ§Ø¬Ø± Ù…Ø¹Ù‡ ÙƒÙ„ Ø´ÙŠØ¡ØŒ Ø§Ù„Ù…Ù†ØµØ© ØªØ±ÙŠØ¯ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ÙÙ‚Ø· (Ù…Ø®ÙØ¶Ø© Ø¨Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹)
                -1 * applied_commission * (1 - refund_percentage)
            ELSE 0
        END AS net_balance_direction

    FROM order_financials
)

SELECT
    provider_id,

    -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    -- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø·Ù„Ø¨Ø§Øª
    -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    COUNT(*) AS total_orders,
    COUNT(*) FILTER (WHERE payment_method = 'cash') AS cod_orders_count,
    COUNT(*) FILTER (WHERE payment_method = 'online') AS online_orders_count,

    -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    -- Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª
    -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    SUM(net_sales) AS total_net_sales,
    SUM(order_total) AS total_gross_sales,
    SUM(delivery_fee) AS total_delivery_fees,
    SUM(discount) AS total_discounts,
    SUM(refund_amount) AS total_refunds,

    -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    -- Ø§Ù„Ø¹Ù…ÙˆÙ„Ø§Øª
    -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    SUM(theoretical_commission) AS total_theoretical_commission,
    SUM(applied_commission * (1 - refund_percentage)) AS total_applied_commission,
    SUM(theoretical_commission - applied_commission) AS grace_period_savings,

    -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    -- ğŸ’µ COD Section
    -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    SUM(cash_in_hand_merchant) AS cod_cash_with_merchant,
    SUM(platform_receivables_from_cod) AS cod_commission_owed_to_platform,

    -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    -- ğŸ’³ Online Section
    -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    SUM(cash_held_by_platform) AS online_cash_with_platform,
    SUM(merchant_receivables_from_online) AS online_payout_owed_to_merchant,

    -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    -- ğŸ“Š Ø§Ù„Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
    -- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    SUM(net_balance_direction) AS final_net_balance,

    -- Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØªØ³ÙˆÙŠØ©
    CASE
        WHEN SUM(net_balance_direction) > 0 THEN 'platform_pays_merchant'
        WHEN SUM(net_balance_direction) < 0 THEN 'merchant_pays_platform'
        ELSE 'balanced'
    END AS settlement_direction,

    -- Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ØªØ­ÙˆÙŠÙ„Ù‡
    ABS(SUM(net_balance_direction)) AS settlement_amount_due,

    -- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­
    MAX(commission_status) AS commission_status,
    MAX(grace_period_end) AS grace_period_end

FROM cash_flow_classified
GROUP BY provider_id;
```

### 2.2 Ø­Ù‚Ù„ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø§Ù„ØªÙˆØµÙŠÙ„ (Ù„Ù„Ù…Ø±ÙˆÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©)

```sql
-- Ø¥Ø¶Ø§ÙØ© Ø­Ù‚Ù„ delivery_responsibility Ù„Ù„ØªØ¬Ø§Ø±
-- Ù‡Ø°Ø§ ÙŠØ­Ù…ÙŠÙƒ Ø¥Ø°Ø§ Ù‚Ø±Ø±Øª Ø§Ù„Ù…Ù†ØµØ© Ø§Ù…ØªÙ„Ø§Ùƒ Ø£Ø³Ø·ÙˆÙ„ ØªÙˆØµÙŠÙ„ Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹

ALTER TABLE providers ADD COLUMN IF NOT EXISTS
    delivery_responsibility TEXT DEFAULT 'merchant'
    CHECK (delivery_responsibility IN ('merchant', 'platform'));

COMMENT ON COLUMN providers.delivery_responsibility IS
    'Ù…Ù† Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„ØªÙˆØµÙŠÙ„: merchant (Ø§Ù„ØªØ§Ø¬Ø±) Ø£Ùˆ platform (Ø§Ù„Ù…Ù†ØµØ©).
     ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ ØªÙˆØ²ÙŠØ¹ Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ ÙÙŠ Ø§Ù„ØªØ³ÙˆÙŠØ§Øª.';

-- Ø­Ø§Ù„ÙŠØ§Ù‹: Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¬Ø§Ø± delivery_responsibility = 'merchant'
-- Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹: Ø¥Ø°Ø§ Ø£ØµØ¨Ø­Øª Ø§Ù„Ù…Ù†ØµØ© ØªÙˆØµÙ‘Ù„ Ù„ØªØ§Ø¬Ø± Ù…Ø¹ÙŠÙ†ØŒ Ù†ØºÙŠØ±Ù‡ Ù„Ù€ 'platform'
```

### 2.3 ØªØ­Ø¯ÙŠØ« SQL View Ù„ÙŠØ±Ø§Ø¹ÙŠ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø§Ù„ØªÙˆØµÙŠÙ„

```sql
-- ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ØŒ ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù€ View Ù„ÙŠØ±Ø§Ø¹ÙŠ delivery_responsibility:
CASE
    WHEN payment_method = 'online' THEN
        CASE
            WHEN p.delivery_responsibility = 'merchant' THEN
                -- Ø§Ù„ØªØ§Ø¬Ø± ÙŠÙˆØµÙ‘Ù„: Ø£Ø¹Ø·Ù‡ Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ (Ø«Ø§Ø¨ØªØ© Ø­ØªÙ‰ Ù…Ø¹ Ø§Ù„Ù…Ø±ØªØ¬Ø¹)
                ((net_sales - applied_commission) * (1 - refund_percentage)) + delivery_fee
            WHEN p.delivery_responsibility = 'platform' THEN
                -- Ø§Ù„Ù…Ù†ØµØ© ØªÙˆØµÙ‘Ù„: Ø§Ø­ØªÙØ¸ Ø¨Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„
                (net_sales - applied_commission) * (1 - refund_percentage)
        END
    WHEN payment_method = 'cash' THEN
        -1 * applied_commission * (1 - refund_percentage)
END AS net_balance_direction
```

### 2.4 Ø­Ù‚Ù„ Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© (Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„)

```sql
-- Ø¥Ø¶Ø§ÙØ© Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ù„Ù„Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ Ù„ØªØ·Ø¨ÙŠÙ‚ VAT Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹

ALTER TABLE settlements ADD COLUMN IF NOT EXISTS
    vat_rate DECIMAL(5,2) DEFAULT 0;  -- Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© (Ù…Ø«Ù„Ø§Ù‹ 14%)

ALTER TABLE settlements ADD COLUMN IF NOT EXISTS
    vat_amount DECIMAL(10,2) DEFAULT 0;  -- Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©

ALTER TABLE settlements ADD COLUMN IF NOT EXISTS
    commission_after_vat DECIMAL(10,2) DEFAULT 0;  -- Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© + Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©

COMMENT ON COLUMN settlements.vat_rate IS
    'Ù†Ø³Ø¨Ø© Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© Ø¹Ù„Ù‰ Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ù†ØµØ© (0% Ø­Ø§Ù„ÙŠØ§Ù‹)';

COMMENT ON COLUMN settlements.vat_amount IS
    'Ù‚ÙŠÙ…Ø© VAT = platform_commission Ã— vat_rate';

COMMENT ON COLUMN settlements.commission_after_vat IS
    'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ­Ù‚ Ù„Ù„Ù…Ù†ØµØ© = platform_commission + vat_amount';

-- Ø¹Ù†Ø¯ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹:
-- UPDATE settlements SET vat_rate = 14.00 WHERE created_at > '2026-01-01';
```

#### Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©:
```
Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ù†ØµØ©: 70 Ø¬.Ù…
Ù†Ø³Ø¨Ø© VAT: 14%
Ù‚ÙŠÙ…Ø© VAT: 70 Ã— 14% = 9.8 Ø¬.Ù…
Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ­Ù‚ Ù„Ù„Ù…Ù†ØµØ©: 70 + 9.8 = 79.8 Ø¬.Ù…
```

### 2.4 Ø¬Ø¯ÙˆÙ„ Ø³Ø¬Ù„ Ø§Ù„ØªØ³ÙˆÙŠØ§Øª Ø§Ù„Ù…Ø­Ø³Ù‘Ù†

```sql
-- ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ settlements

ALTER TABLE settlements ADD COLUMN IF NOT EXISTS
    settlement_direction TEXT CHECK (settlement_direction IN ('platform_pays_merchant', 'merchant_pays_platform', 'balanced'));

ALTER TABLE settlements ADD COLUMN IF NOT EXISTS
    cod_cash_collected DECIMAL(10,2) DEFAULT 0;

ALTER TABLE settlements ADD COLUMN IF NOT EXISTS
    online_cash_collected DECIMAL(10,2) DEFAULT 0;

ALTER TABLE settlements ADD COLUMN IF NOT EXISTS
    theoretical_commission DECIMAL(10,2) DEFAULT 0;

ALTER TABLE settlements ADD COLUMN IF NOT EXISTS
    grace_period_discount DECIMAL(10,2) DEFAULT 0;

ALTER TABLE settlements ADD COLUMN IF NOT EXISTS
    delivery_fees_included DECIMAL(10,2) DEFAULT 0;  -- Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ Ø§Ù„Ù…Ø­ÙˆÙ„Ø© Ù„Ù„ØªØ§Ø¬Ø±

-- Ø¥Ø¶Ø§ÙØ© ÙÙ‡Ø±Ø³ Ù„Ù„Ø£Ø¯Ø§Ø¡
CREATE INDEX IF NOT EXISTS idx_settlements_direction ON settlements(settlement_direction);
CREATE INDEX IF NOT EXISTS idx_settlements_provider_period ON settlements(provider_id, period_start, period_end);
```

---

## 3. Ø¥Ø¹Ø§Ø¯Ø© ØªØµÙ…ÙŠÙ… Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø§Ù„ØªØ§Ø¬Ø±

### 3.1 ÙƒØ±ÙˆØª Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø© (Quick Stats Cards)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© - Ø§Ù„ÙŠÙˆÙ…                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ ğŸ’° Ø¥Ø¬Ù…Ø§Ù„ÙŠ       â”‚  â”‚ ğŸ“¦ Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª  â”‚  â”‚ âš¡ Ù…ØªÙˆØ³Ø· Ø§Ù„Ø·Ù„Ø¨  â”‚             â”‚
â”‚  â”‚    Ù…Ø³ØªØ­Ù‚Ø§ØªÙƒ     â”‚  â”‚                 â”‚  â”‚                 â”‚             â”‚
â”‚  â”‚   1,333.5 Ø¬.Ù…   â”‚  â”‚       15        â”‚  â”‚     83 Ø¬.Ù…      â”‚             â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚             â”‚
â”‚  â”‚ (Ù…Ø¨ÙŠØ¹Ø§Øª+ØªÙˆØµÙŠÙ„   â”‚  â”‚  12 COD | 3 Onlineâ”‚ â”‚                 â”‚             â”‚
â”‚  â”‚   - Ø¹Ù…ÙˆÙ„Ø©)      â”‚  â”‚                 â”‚  â”‚                 â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ ğŸ”„ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª    â”‚  â”‚ ğŸšš Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ â”‚  â”‚ ğŸ“ˆ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©      â”‚             â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚             â”‚
â”‚  â”‚    150 Ø¬.Ù…      â”‚  â”‚    200 Ø¬.Ù…      â”‚  â”‚    66.5 Ø¬.Ù…     â”‚             â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚             â”‚
â”‚  â”‚   Ø·Ù„Ø¨ÙŠÙ† (2)     â”‚  â”‚ âœ… Ø­Ù‚Ùƒ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„  â”‚  â”‚ ğŸ Ø®ØµÙ… 100%     â”‚             â”‚
â”‚  â”‚                 â”‚  â”‚  (ØºÙŠØ± Ø®Ø§Ø¶Ø¹Ø©     â”‚  â”‚ ØªÙˆÙÙŠØ±: 66.5 Ø¬   â”‚             â”‚
â”‚  â”‚                 â”‚  â”‚   Ù„Ù„Ø¹Ù…ÙˆÙ„Ø©)      â”‚  â”‚                 â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚  â”‚              ğŸ“Š ØªÙØµÙŠÙ„ Ù…Ø³ØªØ­Ù‚Ø§ØªÙƒ (Ø¬Ø¯ÙˆÙ„ Ø´ÙØ§Ù)                            â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  Ø§Ù„Ø¨Ù†Ø¯                    â”‚   Ø§Ù„Ù‚ÙŠÙ…Ø©    â”‚  Ø§Ù„Ø­Ø§Ù„Ø©                    â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚
â”‚  â”‚  Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª          â”‚  1,000 Ø¬.Ù…  â”‚  Ø®Ø§Ø¶Ø¹Ø© Ù„Ù„Ø¹Ù…ÙˆÙ„Ø© (7%)        â”‚  â”‚
â”‚  â”‚  Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„             â”‚    200 Ø¬.Ù…  â”‚  âœ… ØºÙŠØ± Ø®Ø§Ø¶Ø¹Ø© (Ø­Ù‚Ùƒ ÙƒØ§Ù…Ù„Ø§Ù‹)  â”‚  â”‚
â”‚  â”‚  (-) Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª            â”‚    (50) Ø¬.Ù… â”‚  ØªÙØ®ØµÙ… Ù…Ù† ÙˆØ¹Ø§Ø¡ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©     â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚
â”‚  â”‚  = ÙˆØ¹Ø§Ø¡ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©           â”‚    950 Ø¬.Ù…  â”‚  (Ù…Ø¨ÙŠØ¹Ø§Øª - Ù…Ø±ØªØ¬Ø¹Ø§Øª)        â”‚  â”‚
â”‚  â”‚  (-) Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ù†ØµØ© (7%)    â”‚  (66.5) Ø¬.Ù… â”‚  ğŸ Ø®ØµÙ… ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­: 100%  â”‚  â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚  â”‚
â”‚  â”‚  ğŸ’° Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø³ØªØ­Ù‚Ø§ØªÙƒ       â”‚ 1,133.5 Ø¬.Ù… â”‚  (950 + 200 - 16.5*)       â”‚  â”‚
â”‚  â”‚                           â”‚             â”‚  *Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ÙƒÙˆØ¯ Ù…ÙƒÙˆÙ† Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª

```typescript
// src/components/provider/finance/QuickStatsCards.tsx

interface QuickStatsProps {
  netSales: number;           // ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©
  grossSales: number;         // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª
  ordersCount: number;
  codOrdersCount: number;
  onlineOrdersCount: number;
  avgOrderValue: number;
  refundsAmount: number;
  refundsCount: number;
  deliveryFees: number;       // Ø¨Ù†Ø¯ Ù…Ù†ÙØµÙ„
  appliedCommission: number;  // Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø·Ø¨Ù‚Ø© ÙØ¹Ù„ÙŠØ§Ù‹
  theoreticalCommission: number; // Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù†Ø¸Ø±ÙŠØ© (Ù‚Ø¨Ù„ ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­)
  isInGracePeriod: boolean;
  gracePeriodEnd?: string;
}

const QuickStatsCards: React.FC<QuickStatsProps> = ({
  netSales,
  grossSales,
  ordersCount,
  codOrdersCount,
  onlineOrdersCount,
  avgOrderValue,
  refundsAmount,
  refundsCount,
  deliveryFees,
  appliedCommission,
  theoreticalCommission,
  isInGracePeriod,
  gracePeriodEnd
}) => {
  const commissionSavings = theoreticalCommission - appliedCommission;
  const discountPercentage = isInGracePeriod ? 100 : 0;

  return (
    <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">

      {/* ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª */}
      <Card className="bg-gradient-to-br from-emerald-50 to-green-50 border-emerald-200">
        <CardContent className="p-4">
          <div className="flex items-center gap-2 mb-2">
            <Wallet className="w-5 h-5 text-emerald-600" />
            <span className="text-sm text-emerald-700 font-medium">ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</span>
          </div>
          <div className="text-2xl font-bold text-emerald-800">
            {formatCurrency(netSales)}
          </div>
          <div className="text-xs text-emerald-600 mt-1">
            Ø¨Ø¹Ø¯ Ø®ØµÙ… Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© ÙˆØ§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª
          </div>
        </CardContent>
      </Card>

      {/* Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª */}
      <Card className="bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200">
        <CardContent className="p-4">
          <div className="flex items-center gap-2 mb-2">
            <Package className="w-5 h-5 text-blue-600" />
            <span className="text-sm text-blue-700 font-medium">Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</span>
          </div>
          <div className="text-2xl font-bold text-blue-800">
            {ordersCount}
          </div>
          <div className="text-xs text-blue-600 mt-1">
            ğŸ’µ {codOrdersCount} COD | ğŸ’³ {onlineOrdersCount} Online
          </div>
        </CardContent>
      </Card>

      {/* Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª */}
      <Card className="bg-gradient-to-br from-amber-50 to-orange-50 border-amber-200">
        <CardContent className="p-4">
          <div className="flex items-center gap-2 mb-2">
            <RotateCcw className="w-5 h-5 text-amber-600" />
            <span className="text-sm text-amber-700 font-medium">Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª</span>
          </div>
          <div className="text-2xl font-bold text-amber-800">
            {formatCurrency(refundsAmount)}
          </div>
          <div className="text-xs text-amber-600 mt-1">
            {refundsCount} Ø·Ù„Ø¨/Ø·Ù„Ø¨Ø§Øª
          </div>
        </CardContent>
      </Card>

      {/* Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ */}
      <Card className="bg-gradient-to-br from-slate-50 to-gray-50 border-slate-200">
        <CardContent className="p-4">
          <div className="flex items-center gap-2 mb-2">
            <Truck className="w-5 h-5 text-slate-600" />
            <span className="text-sm text-slate-700 font-medium">Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</span>
          </div>
          <div className="text-2xl font-bold text-slate-800">
            {formatCurrency(deliveryFees)}
          </div>
          <div className="text-xs text-slate-500 mt-1 flex items-center gap-1">
            <Info className="w-3 h-3" />
            Ù„Ø§ ØªÙØ­Ø³Ø¨ Ø¶Ù…Ù† Ù…Ø¨ÙŠØ¹Ø§ØªÙƒ
          </div>
        </CardContent>
      </Card>

      {/* Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© - Ù…Ø¹ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªÙˆÙÙŠØ± */}
      <Card className={cn(
        "border-2 col-span-2 md:col-span-1",
        isInGracePeriod
          ? "bg-gradient-to-br from-purple-50 to-violet-50 border-purple-300"
          : "bg-gradient-to-br from-rose-50 to-pink-50 border-rose-200"
      )}>
        <CardContent className="p-4">
          <div className="flex items-center justify-between mb-2">
            <div className="flex items-center gap-2">
              <Percent className="w-5 h-5 text-purple-600" />
              <span className="text-sm text-purple-700 font-medium">Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©</span>
            </div>
            {isInGracePeriod && (
              <Badge className="bg-purple-100 text-purple-700 text-xs">
                ğŸ ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­
              </Badge>
            )}
          </div>

          {/* Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù†Ø¸Ø±ÙŠØ© (Ù…Ø§ ÙƒØ§Ù† Ø³ÙŠÙØ®ØµÙ…) */}
          <div className="flex items-center gap-2">
            <span className={cn(
              "text-lg font-bold",
              isInGracePeriod ? "line-through text-slate-400" : "text-rose-700"
            )}>
              {formatCurrency(theoreticalCommission)}
            </span>
            {isInGracePeriod && (
              <Badge variant="outline" className="text-purple-600 border-purple-300">
                Ø®ØµÙ… {discountPercentage}%
              </Badge>
            )}
          </div>

          {/* Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ© */}
          {isInGracePeriod && (
            <div className="mt-2 p-2 bg-white/50 rounded-lg">
              <div className="flex justify-between text-sm">
                <span className="text-slate-600">Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ÙØ¹Ù„ÙŠØ§Ù‹:</span>
                <span className="font-bold text-emerald-600">{formatCurrency(appliedCommission)}</span>
              </div>
              <div className="flex justify-between text-sm mt-1">
                <span className="text-slate-600">ØªÙˆÙÙŠØ±Ùƒ:</span>
                <span className="font-bold text-purple-600">+{formatCurrency(commissionSavings)}</span>
              </div>
            </div>
          )}

          {/* ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ */}
          {isInGracePeriod && gracePeriodEnd && (
            <div className="text-xs text-purple-600 mt-2 flex items-center gap-1">
              <Clock className="w-3 h-3" />
              ØªÙ†ØªÙ‡ÙŠ ÙÙŠ: {formatDate(gracePeriodEnd)}
            </div>
          )}
        </CardContent>
      </Card>

    </div>
  );
};
```

---

## 4. ØµÙØ­Ø© Ø§Ù„ØªØ³ÙˆÙŠØ§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„ØªØ§Ø¬Ø±

### 4.1 Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„ØªØ³ÙˆÙŠØ© Ø§Ù„ÙˆØ§Ø¶Ø­Ø©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ğŸ“‹ ÙƒØ´Ù Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ³ÙˆÙŠØ©                                  â”‚
â”‚                     Ø§Ù„ÙØªØ±Ø©: 20-25 Ø¯ÙŠØ³Ù…Ø¨Ø± 2025                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ğŸ’µ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (COD)                 â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª (12 Ø·Ù„Ø¨)                           1,500.00 Ø¬.Ù…   â”‚   â”‚
â”‚  â”‚  (-) Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„                                    - 150.00 Ø¬.Ù…   â”‚   â”‚
â”‚  â”‚  (-) Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶                                 - 50.00 Ø¬.Ù…   â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  = ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª                                    1,300.00 Ø¬.Ù…   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø© (7%)                                91.00 Ø¬.Ù…    â”‚   â”‚
â”‚  â”‚  (-) Ø®ØµÙ… ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ (100%)                          - 91.00 Ø¬.Ù…   â”‚   â”‚
â”‚  â”‚  (-) ØªØ¹Ø¯ÙŠÙ„ Ù…Ø±ØªØ¬Ø¹Ø§Øª (Ø·Ù„Ø¨ #123)                         - 0.00 Ø¬.Ù…   â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  = Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø³Ø¯Ø§Ø¯Ù‡Ø§ Ù„Ù„Ù…Ù†ØµØ©                       0.00 Ø¬.Ù…    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  ğŸ’¡ Ø§Ù„ÙƒØ§Ø´ Ù…Ø¹Ùƒ: 1,300.00 Ø¬.Ù… | Ø£Ù†Øª Ù…Ø¯ÙŠÙ† Ù„Ù„Ù…Ù†ØµØ© Ø¨Ù€: 0.00 Ø¬.Ù…         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ğŸ’³ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Online)                â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ØµÙ‘Ù„ (3 Ø·Ù„Ø¨Ø§Øª)                             500.00 Ø¬.Ù…   â”‚   â”‚
â”‚  â”‚  (-) Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„                                     - 45.00 Ø¬.Ù…   â”‚   â”‚
â”‚  â”‚  (-) Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª                                          - 0.00 Ø¬.Ù…   â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  = ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª                                      455.00 Ø¬.Ù…   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  (-) Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© (7%)                                     - 31.85 Ø¬.Ù…   â”‚   â”‚
â”‚  â”‚  (+) Ø®ØµÙ… ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ (100%)                          + 31.85 Ø¬.Ù…   â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  = Ù…Ø³ØªØ­Ù‚Ø§ØªÙƒ Ù„Ø¯Ù‰ Ø§Ù„Ù…Ù†ØµØ©                                455.00 Ø¬.Ù…   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  ğŸ’¡ Ø§Ù„ÙƒØ§Ø´ Ù…Ø¹ Ø§Ù„Ù…Ù†ØµØ©: 500.00 Ø¬.Ù… | Ø§Ù„Ù…Ù†ØµØ© Ù…Ø¯ÙŠÙ†Ø© Ù„Ùƒ Ø¨Ù€: 455.00 Ø¬.Ù…   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         ğŸ“Š Ø§Ù„Ø®Ù„Ø§ØµØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©                          â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚   Ù…Ø³ØªØ­Ù‚Ø§ØªÙƒ Ù…Ù† Ø§Ù„Ù…Ù†ØµØ© (Online):              + 455.00 Ø¬.Ù…           â”‚   â”‚
â”‚  â”‚   Ù…Ø¯ÙŠÙˆÙ†ÙŠØªÙƒ Ù„Ù„Ù…Ù†ØµØ© (COD Commission):          - 0.00 Ø¬.Ù…            â”‚   â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚   â”‚  ğŸ’° Ø§Ù„Ù…ÙŠØ²Ø§Ù† Ø§Ù„ØµØ§ÙÙŠ: + 455.00 Ø¬.Ù…                        â”‚      â”‚   â”‚
â”‚  â”‚   â”‚  â¬…ï¸ Ø§Ù„Ù…Ù†ØµØ© Ø³ØªØ­ÙˆÙ„ Ù„Ùƒ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¨Ù„Øº                          â”‚      â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Ù…ÙƒÙˆÙ† Ø¹Ø±Ø¶ Ø§Ù„ØªØ³ÙˆÙŠØ©

```typescript
// src/components/provider/finance/SettlementBreakdown.tsx

interface SettlementBreakdownProps {
  settlement: {
    // COD Section
    cod_gross_sales: number;
    cod_delivery_fees: number;
    cod_discounts: number;
    cod_net_sales: number;
    cod_theoretical_commission: number;
    cod_grace_discount: number;
    cod_refund_adjustment: number;
    cod_commission_due: number;

    // Online Section
    online_gross_collected: number;
    online_delivery_fees: number;
    online_discounts: number;
    online_net_sales: number;
    online_theoretical_commission: number;
    online_grace_discount: number;
    online_refund_adjustment: number;
    online_payout_due: number;

    // Summary
    final_net_balance: number;
    settlement_direction: 'platform_pays_merchant' | 'merchant_pays_platform' | 'balanced';

    // Meta
    period_start: string;
    period_end: string;
    orders_count: number;
    cod_orders_count: number;
    online_orders_count: number;
    is_in_grace_period: boolean;
  };
}

const SettlementBreakdown: React.FC<SettlementBreakdownProps> = ({ settlement }) => {
  const isPositiveBalance = settlement.final_net_balance > 0;
  const isNegativeBalance = settlement.final_net_balance < 0;

  return (
    <div className="space-y-6">
      {/* Header */}
      <Card className="bg-gradient-to-r from-primary/5 to-primary/10">
        <CardHeader>
          <CardTitle className="flex items-center gap-2">
            <FileText className="w-6 h-6" />
            ÙƒØ´Ù Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ³ÙˆÙŠØ©
          </CardTitle>
          <CardDescription>
            Ø§Ù„ÙØªØ±Ø©: {formatDate(settlement.period_start)} - {formatDate(settlement.period_end)}
          </CardDescription>
        </CardHeader>
      </Card>

      {/* COD Section */}
      {settlement.cod_orders_count > 0 && (
        <Card className="border-amber-200 bg-amber-50/50">
          <CardHeader className="pb-2">
            <CardTitle className="text-lg flex items-center gap-2 text-amber-800">
              <Banknote className="w-5 h-5" />
              ğŸ’µ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (COD)
              <Badge variant="outline" className="mr-auto">
                {settlement.cod_orders_count} Ø·Ù„Ø¨
              </Badge>
            </CardTitle>
          </CardHeader>
          <CardContent>
            <CalculationTable
              items={[
                { label: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª', value: settlement.cod_gross_sales, type: 'neutral' },
                { label: 'Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„', value: -settlement.cod_delivery_fees, type: 'subtract', note: 'Ù„Ø§ ØªÙØ­Ø³Ø¨ Ø¶Ù…Ù† Ù…Ø¨ÙŠØ¹Ø§ØªÙƒ' },
                { label: 'Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶', value: -settlement.cod_discounts, type: 'subtract' },
                { label: 'ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª', value: settlement.cod_net_sales, type: 'subtotal' },
                { type: 'divider' },
                { label: 'Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø© (7%)', value: settlement.cod_theoretical_commission, type: 'neutral' },
                { label: 'Ø®ØµÙ… ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­', value: -settlement.cod_grace_discount, type: 'subtract', highlight: settlement.is_in_grace_period },
                { label: 'ØªØ¹Ø¯ÙŠÙ„ Ù…Ø±ØªØ¬Ø¹Ø§Øª', value: -settlement.cod_refund_adjustment, type: 'subtract' },
                { label: 'Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø³Ø¯Ø§Ø¯Ù‡Ø§', value: settlement.cod_commission_due, type: 'total' },
              ]}
            />
            <div className="mt-4 p-3 bg-amber-100 rounded-lg flex items-center justify-between text-sm">
              <span className="text-amber-800">ğŸ’¡ Ø§Ù„ÙƒØ§Ø´ Ù…Ø¹Ùƒ:</span>
              <span className="font-bold text-amber-900">{formatCurrency(settlement.cod_net_sales)}</span>
            </div>
          </CardContent>
        </Card>
      )}

      {/* Online Section */}
      {settlement.online_orders_count > 0 && (
        <Card className="border-blue-200 bg-blue-50/50">
          <CardHeader className="pb-2">
            <CardTitle className="text-lg flex items-center gap-2 text-blue-800">
              <CreditCard className="w-5 h-5" />
              ğŸ’³ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Online)
              <Badge variant="outline" className="mr-auto">
                {settlement.online_orders_count} Ø·Ù„Ø¨
              </Badge>
            </CardTitle>
          </CardHeader>
          <CardContent>
            <CalculationTable
              items={[
                { label: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ØµÙ‘Ù„', value: settlement.online_gross_collected, type: 'neutral' },
                { label: 'Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„', value: -settlement.online_delivery_fees, type: 'subtract' },
                { label: 'Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª', value: -settlement.online_discounts, type: 'subtract' },
                { label: 'ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª', value: settlement.online_net_sales, type: 'subtotal' },
                { type: 'divider' },
                { label: 'Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© (7%)', value: -settlement.online_theoretical_commission, type: 'subtract' },
                { label: 'Ø®ØµÙ… ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­', value: settlement.online_grace_discount, type: 'add', highlight: settlement.is_in_grace_period },
                { label: 'Ù…Ø³ØªØ­Ù‚Ø§ØªÙƒ Ù„Ø¯Ù‰ Ø§Ù„Ù…Ù†ØµØ©', value: settlement.online_payout_due, type: 'total' },
              ]}
            />
            <div className="mt-4 p-3 bg-blue-100 rounded-lg flex items-center justify-between text-sm">
              <span className="text-blue-800">ğŸ’¡ Ø§Ù„ÙƒØ§Ø´ Ù…Ø¹ Ø§Ù„Ù…Ù†ØµØ©:</span>
              <span className="font-bold text-blue-900">{formatCurrency(settlement.online_gross_collected)}</span>
            </div>
          </CardContent>
        </Card>
      )}

      {/* Final Summary */}
      <Card className={cn(
        "border-2",
        isPositiveBalance && "border-emerald-400 bg-emerald-50",
        isNegativeBalance && "border-rose-400 bg-rose-50",
        !isPositiveBalance && !isNegativeBalance && "border-slate-300 bg-slate-50"
      )}>
        <CardHeader>
          <CardTitle className="text-lg">ğŸ“Š Ø§Ù„Ø®Ù„Ø§ØµØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</CardTitle>
        </CardHeader>
        <CardContent>
          <div className="space-y-2">
            <div className="flex justify-between">
              <span>Ù…Ø³ØªØ­Ù‚Ø§ØªÙƒ Ù…Ù† Ø§Ù„Ù…Ù†ØµØ© (Online):</span>
              <span className="font-medium text-emerald-600">+{formatCurrency(settlement.online_payout_due)}</span>
            </div>
            <div className="flex justify-between">
              <span>Ù…Ø¯ÙŠÙˆÙ†ÙŠØªÙƒ Ù„Ù„Ù…Ù†ØµØ© (COD Commission):</span>
              <span className="font-medium text-rose-600">-{formatCurrency(settlement.cod_commission_due)}</span>
            </div>
            <Separator className="my-3" />
            <div className={cn(
              "p-4 rounded-lg text-center",
              isPositiveBalance && "bg-emerald-100",
              isNegativeBalance && "bg-rose-100",
              !isPositiveBalance && !isNegativeBalance && "bg-slate-100"
            )}>
              <div className="text-sm text-muted-foreground mb-1">Ø§Ù„Ù…ÙŠØ²Ø§Ù† Ø§Ù„ØµØ§ÙÙŠ</div>
              <div className={cn(
                "text-3xl font-bold",
                isPositiveBalance && "text-emerald-700",
                isNegativeBalance && "text-rose-700"
              )}>
                {isPositiveBalance ? '+' : ''}{formatCurrency(settlement.final_net_balance)}
              </div>
              <div className="text-sm mt-2 flex items-center justify-center gap-2">
                {isPositiveBalance && (
                  <>
                    <ArrowLeft className="w-4 h-4 text-emerald-600" />
                    <span className="text-emerald-700">Ø§Ù„Ù…Ù†ØµØ© Ø³ØªØ­ÙˆÙ„ Ù„Ùƒ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¨Ù„Øº</span>
                  </>
                )}
                {isNegativeBalance && (
                  <>
                    <ArrowRight className="w-4 h-4 text-rose-600" />
                    <span className="text-rose-700">Ù…Ø·Ù„ÙˆØ¨ Ø³Ø¯Ø§Ø¯ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ù„Ù…Ù†ØµØ©</span>
                  </>
                )}
                {!isPositiveBalance && !isNegativeBalance && (
                  <span className="text-slate-600">âœ“ Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…ØªÙˆØ§Ø²Ù†</span>
                )}
              </div>
            </div>
          </div>
        </CardContent>
      </Card>
    </div>
  );
};
```

---

## 5. Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©

### 5.1 Ø¬Ø¯ÙˆÙ„ Ù…Ù„Ø®Øµ Ø§Ù„ØªØ¬Ø§Ø±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ğŸ“Š Ù…Ù„Ø®Øµ Ø§Ù„ØªØ³ÙˆÙŠØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©                                 â”‚
â”‚                                  Ø§Ù„ÙØªØ±Ø©: Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø±     â”‚ Ù…Ø¨ÙŠØ¹Ø§Øª COD â”‚ Ù…Ø¨ÙŠØ¹Ø§Øª Online â”‚  Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©  â”‚ Ø§Ù„ØµØ§ÙÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ â”‚ Ø§Ù„Ø§ØªØ¬Ø§Ù‡  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  Ù…Ø·Ø¹Ù… Ø§Ù„Ø¨Ø±ÙƒØ©   â”‚ 1,000 Ø¬.Ù…  â”‚    500 Ø¬.Ù…    â”‚  105 Ø¬.Ù…  â”‚  + 395 Ø¬.Ù…    â”‚  â¬…ï¸ Ù„Ù‡Ù…  â”‚
â”‚  Ø³ÙˆØ¨Ø± Ù…Ø§Ø±ÙƒØª   â”‚ 2,500 Ø¬.Ù…  â”‚      0 Ø¬.Ù…    â”‚  175 Ø¬.Ù…  â”‚  - 175 Ø¬.Ù…    â”‚  â¡ï¸ Ø¹Ù„ÙŠÙ†Ø§ â”‚
â”‚  ØµÙŠØ¯Ù„ÙŠØ© Ø§Ù„Ø´ÙØ§Ø¡ â”‚   800 Ø¬.Ù…  â”‚  1,200 Ø¬.Ù…    â”‚  140 Ø¬.Ù…  â”‚  + 660 Ø¬.Ù…    â”‚  â¬…ï¸ Ù„Ù‡Ù…  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                                      â”‚
â”‚  ğŸ“ˆ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±:     1,055 Ø¬.Ù…                                            â”‚
â”‚  ğŸ“‰ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„Ù…Ù†ØµØ©:       175 Ø¬.Ù…                                            â”‚
â”‚  ğŸ’° ØµØ§ÙÙŠ Ø§Ù„ØªØ³ÙˆÙŠØ©:              + 880 Ø¬.Ù… (Ø§Ù„Ù…Ù†ØµØ© ØªØ¯ÙØ¹)                              â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ÙƒØ±ÙˆØª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø© Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©

```typescript
// src/components/admin/finance/AdminFinanceStats.tsx

interface AdminFinanceStatsProps {
  stats: {
    total_gross_revenue: number;
    total_net_sales: number;
    total_delivery_fees: number;
    total_theoretical_commission: number;
    total_applied_commission: number;
    total_grace_period_discount: number;
    total_refunds: number;

    // Cash Flow
    cash_with_merchants: number;      // COD collected
    cash_with_platform: number;       // Online collected

    // Settlements
    platform_receivables: number;     // Ù…Ù† Ø§Ù„ØªØ¬Ø§Ø± (COD commission)
    platform_payables: number;        // Ù„Ù„ØªØ¬Ø§Ø± (Online payout)
    net_settlement: number;           // Ø§Ù„ØµØ§ÙÙŠ

    // Counts
    total_orders: number;
    cod_orders: number;
    online_orders: number;
    providers_count: number;
  };
}

const AdminFinanceStats: React.FC<AdminFinanceStatsProps> = ({ stats }) => {
  const isPlatformPaying = stats.net_settlement > 0;

  return (
    <div className="space-y-6">

      {/* Row 1: Revenue Overview */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
        <StatCard
          title="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª"
          value={stats.total_gross_revenue}
          icon={<TrendingUp />}
          color="primary"
          subtitle={`${stats.total_orders} Ø·Ù„Ø¨`}
        />
        <StatCard
          title="ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"
          value={stats.total_net_sales}
          icon={<DollarSign />}
          color="success"
          subtitle="Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª"
        />
        <StatCard
          title="Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ù…ÙˆÙ„Ø§Øª"
          value={stats.total_applied_commission}
          icon={<Percent />}
          color="info"
          subtitle={`Ù†Ø¸Ø±ÙŠ: ${formatCurrency(stats.total_theoretical_commission)}`}
        />
        <StatCard
          title="Ø®ØµÙ… ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­"
          value={stats.total_grace_period_discount}
          icon={<Gift />}
          color="purple"
          subtitle="ØªÙˆÙÙŠØ± Ù„Ù„ØªØ¬Ø§Ø±"
        />
      </div>

      {/* Row 2: Cash Flow */}
      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        <Card className="border-amber-200 bg-amber-50/50">
          <CardHeader className="pb-2">
            <CardTitle className="text-lg flex items-center gap-2">
              <Banknote className="w-5 h-5 text-amber-600" />
              ğŸ’µ Ø§Ù„ÙƒØ§Ø´ Ø¹Ù†Ø¯ Ø§Ù„ØªØ¬Ø§Ø± (COD)
            </CardTitle>
          </CardHeader>
          <CardContent>
            <div className="text-3xl font-bold text-amber-800">
              {formatCurrency(stats.cash_with_merchants)}
            </div>
            <div className="mt-2 text-sm text-amber-700">
              Ù…Ù† {stats.cod_orders} Ø·Ù„Ø¨ COD
            </div>
            <Separator className="my-3" />
            <div className="flex justify-between text-sm">
              <span>Ø¹Ù…ÙˆÙ„Ø§Øª Ù…Ø³ØªØ­Ù‚Ø© Ù„Ù†Ø§:</span>
              <span className="font-bold text-amber-900">
                {formatCurrency(stats.platform_receivables)}
              </span>
            </div>
          </CardContent>
        </Card>

        <Card className="border-blue-200 bg-blue-50/50">
          <CardHeader className="pb-2">
            <CardTitle className="text-lg flex items-center gap-2">
              <CreditCard className="w-5 h-5 text-blue-600" />
              ğŸ’³ Ø§Ù„ÙƒØ§Ø´ Ø¹Ù†Ø¯Ù†Ø§ (Online)
            </CardTitle>
          </CardHeader>
          <CardContent>
            <div className="text-3xl font-bold text-blue-800">
              {formatCurrency(stats.cash_with_platform)}
            </div>
            <div className="mt-2 text-sm text-blue-700">
              Ù…Ù† {stats.online_orders} Ø·Ù„Ø¨ Online
            </div>
            <Separator className="my-3" />
            <div className="flex justify-between text-sm">
              <span>Ù…Ø³ØªØ­Ù‚Ø§Øª Ù„Ù„ØªØ¬Ø§Ø±:</span>
              <span className="font-bold text-blue-900">
                {formatCurrency(stats.platform_payables)}
              </span>
            </div>
          </CardContent>
        </Card>
      </div>

      {/* Row 3: Net Settlement */}
      <Card className={cn(
        "border-2",
        isPlatformPaying ? "border-rose-300 bg-rose-50" : "border-emerald-300 bg-emerald-50"
      )}>
        <CardContent className="py-6">
          <div className="text-center">
            <div className="text-sm text-muted-foreground mb-2">ØµØ§ÙÙŠ Ø§Ù„ØªØ³ÙˆÙŠØ©</div>
            <div className={cn(
              "text-4xl font-bold",
              isPlatformPaying ? "text-rose-700" : "text-emerald-700"
            )}>
              {formatCurrency(Math.abs(stats.net_settlement))}
            </div>
            <div className="mt-3 flex items-center justify-center gap-2 text-lg">
              {isPlatformPaying ? (
                <>
                  <ArrowRight className="w-6 h-6 text-rose-600" />
                  <span className="text-rose-700 font-medium">Ø§Ù„Ù…Ù†ØµØ© ØªØ¯ÙØ¹ Ù„Ù„ØªØ¬Ø§Ø±</span>
                </>
              ) : (
                <>
                  <ArrowLeft className="w-6 h-6 text-emerald-600" />
                  <span className="text-emerald-700 font-medium">Ø§Ù„ØªØ¬Ø§Ø± ÙŠØ¯ÙØ¹ÙˆÙ† Ù„Ù„Ù…Ù†ØµØ©</span>
                </>
              )}
            </div>
          </div>
        </CardContent>
      </Card>

    </div>
  );
};
```

---

## 6. Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ø±Ø­Ù„ÙŠØ©

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª âœ… (Ù…ÙƒØªÙ…Ù„Ø©)

| # | Ø§Ù„Ù…Ù‡Ù…Ø© | Ø§Ù„Ù…Ù„Ù | Ø§Ù„Ø­Ø§Ù„Ø© |
|---|--------|-------|--------|
| 1.1 | Ø¥Ù†Ø´Ø§Ø¡ View: `financial_settlement_engine` | `migrations/20251225100000_*.sql` | âœ… |
| 1.2 | ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ `settlements` Ø¨Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© | `migrations/20251225100000_*.sql` | âœ… |
| 1.3 | ØªØ­Ø¯ÙŠØ« trigger Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© | `migrations/20251225100000_*.sql` | âœ… |
| 1.4 | Ø¥Ù†Ø´Ø§Ø¡ function: `generate_settlement_from_view` | `app/[locale]/admin/settlements/page.tsx` | âœ… |

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ§Ø¬Ø± âœ… (Ù…ÙƒØªÙ…Ù„Ø©)

| # | Ø§Ù„Ù…Ù‡Ù…Ø© | Ø§Ù„Ù…Ù„Ù | Ø§Ù„Ø­Ø§Ù„Ø© |
|---|--------|-------|--------|
| 2.1 | Ø¥Ù†Ø´Ø§Ø¡ `QuickStatsCards` (inline) | `app/[locale]/provider/finance/page.tsx` | âœ… |
| 2.2 | Ø¥Ù†Ø´Ø§Ø¡ `SettlementBreakdown` (inline) | `app/[locale]/provider/finance/page.tsx` | âœ… |
| 2.3 | ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© `/provider/finance` | `app/[locale]/provider/finance/page.tsx` | âœ… |
| 2.4 | ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© `/provider/analytics` | `app/[locale]/provider/analytics/page.tsx` | âœ… |
| 2.5 | Realtime subscriptions Ù„Ù„ØªØ§Ø¬Ø± | `app/[locale]/provider/finance/page.tsx` | âœ… |

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© âœ… (Ù…ÙƒØªÙ…Ù„Ø©)

| # | Ø§Ù„Ù…Ù‡Ù…Ø© | Ø§Ù„Ù…Ù„Ù | Ø§Ù„Ø­Ø§Ù„Ø© |
|---|--------|-------|--------|
| 3.1 | Ø¥Ù†Ø´Ø§Ø¡ `useAdminFinancialData` hook | `src/hooks/useFinancialData.ts` | âœ… |
| 3.2 | ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© `/admin/settlements` | `app/[locale]/admin/settlements/page.tsx` | âœ… |
| 3.3 | ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© `/admin/finance` | `app/[locale]/admin/finance/page.tsx` | âœ… |
| 3.4 | ØªØ­Ø¯ÙŠØ« `/admin/settlements/[id]` + Audit Trail | `app/[locale]/admin/settlements/[id]/page.tsx` | âœ… |
| 3.5 | Ø¥Ø¶Ø§ÙØ© PDF Export | `src/lib/finance/export-service.ts` | âœ… |
| 3.6 | Ø¥Ø¶Ø§ÙØ© CSV Export | `app/[locale]/admin/settlements/page.tsx` | âœ… |

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 4: Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙˆØ§Ù„ØªÙˆØ«ÙŠÙ‚ (Ù‚ÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„)

| # | Ø§Ù„Ù…Ù‡Ù…Ø© | Ø§Ù„Ù…Ù„Ù | Ø§Ù„Ø­Ø§Ù„Ø© |
|---|--------|-------|--------|
| 4.1 | Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª E2E Ù„Ù„ØªØ³ÙˆÙŠØ§Øª | `e2e/settlements.spec.ts` | ğŸ”„ |
| 4.2 | ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙˆØ«ÙŠÙ‚ | `docs/` | ğŸ”„ |
| 4.3 | Ø§Ø®ØªØ¨Ø§Ø± Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª | Manual testing | ğŸ”„ |

---

## 7. Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 1: ØªØ§Ø¬Ø± ÙÙŠ ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ Ù…Ø¹ COD ÙÙ‚Ø·
```
Input:
- 10 Ø·Ù„Ø¨Ø§Øª COD
- Ù…Ø¨ÙŠØ¹Ø§Øª Ù…Ù†ØªØ¬Ø§Øª: 900 Ø¬.Ù…
- Ø±Ø³ÙˆÙ… ØªÙˆØµÙŠÙ„: 100 Ø¬.Ù…
- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø­ØµÙ‘Ù„: 1000 Ø¬.Ù…
- ÙØªØ±Ø© Ø³Ù…Ø§Ø­ Ù†Ø´Ø·Ø©

Expected:
- ÙˆØ¹Ø§Ø¡ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©: 900 Ø¬.Ù… (Ù…Ø¨ÙŠØ¹Ø§Øª ÙÙ‚Ø·ØŒ Ø¨Ø¯ÙˆÙ† Ø§Ù„ØªÙˆØµÙŠÙ„)
- Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù†Ø¸Ø±ÙŠØ©: 63 Ø¬.Ù… (7% Ã— 900)
- Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ©: 0 Ø¬.Ù… (ÙØªØ±Ø© Ø³Ù…Ø§Ø­)
- Ø§Ù„ÙƒØ§Ø´ Ù…Ø¹ Ø§Ù„ØªØ§Ø¬Ø±: 1000 Ø¬.Ù… (ÙƒÙ„ Ø´ÙŠØ¡!)
- Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© Ø§Ù„ØªØ§Ø¬Ø± Ù„Ù„Ù…Ù†ØµØ©: 0 Ø¬.Ù…
- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„ØªØ§Ø¬Ø±: 1000 Ø¬.Ù… âœ…
```

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 2: ØªØ§Ø¬Ø± Ø¨Ø¯ÙˆÙ† ÙØªØ±Ø© Ø³Ù…Ø§Ø­ Ù…Ø¹ Online ÙÙ‚Ø·
```
Input:
- 5 Ø·Ù„Ø¨Ø§Øª Online
- Ù…Ø¨ÙŠØ¹Ø§Øª Ù…Ù†ØªØ¬Ø§Øª: 450 Ø¬.Ù…
- Ø±Ø³ÙˆÙ… ØªÙˆØµÙŠÙ„: 50 Ø¬.Ù…
- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø­ØµÙ‘Ù„ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù…Ù†ØµØ©: 500 Ø¬.Ù…
- Ø¨Ø¯ÙˆÙ† ÙØªØ±Ø© Ø³Ù…Ø§Ø­

Expected:
- ÙˆØ¹Ø§Ø¡ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©: 450 Ø¬.Ù… (Ù…Ø¨ÙŠØ¹Ø§Øª ÙÙ‚Ø·)
- Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©: 31.5 Ø¬.Ù… (7% Ã— 450)
- Ø§Ù„ÙƒØ§Ø´ Ù…Ø¹ Ø§Ù„Ù…Ù†ØµØ©: 500 Ø¬.Ù…
- Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„ØªØ§Ø¬Ø±: (450 - 31.5) + 50 = 468.5 Ø¬.Ù… âœ…
                   (ØµØ§ÙÙŠ Ù…Ø¨ÙŠØ¹Ø§Øª - Ø¹Ù…ÙˆÙ„Ø© + Ø±Ø³ÙˆÙ… ØªÙˆØµÙŠÙ„)
```

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 3: Ù…Ø²ÙŠØ¬ COD + Online Ù…Ø¹ Ù…Ø±ØªØ¬Ø¹
```
Input:
- 5 Ø·Ù„Ø¨Ø§Øª COD:
  - Ù…Ø¨ÙŠØ¹Ø§Øª: 450 Ø¬.Ù…
  - ØªÙˆØµÙŠÙ„: 50 Ø¬.Ù…
  - Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 500 Ø¬.Ù…
- 3 Ø·Ù„Ø¨Ø§Øª Online:
  - Ù…Ø¨ÙŠØ¹Ø§Øª: 270 Ø¬.Ù…
  - ØªÙˆØµÙŠÙ„: 30 Ø¬.Ù…
  - Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 300 Ø¬.Ù…
- Ù…Ø±ØªØ¬Ø¹ Ù…Ù† Ø·Ù„Ø¨ COD: 100 Ø¬.Ù… (20% Ù…Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ COD)
- Ø¨Ø¯ÙˆÙ† ÙØªØ±Ø© Ø³Ù…Ø§Ø­

Expected:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ COD Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø±ØªØ¬Ø¹:                                                â”‚
â”‚   - Ù…Ø¨ÙŠØ¹Ø§Øª ØµØ§ÙÙŠØ©: 450 Ã— 80% = 360 Ø¬.Ù…                          â”‚
â”‚   - Ø¹Ù…ÙˆÙ„Ø© COD: 360 Ã— 7% = 25.2 Ø¬.Ù…                             â”‚
â”‚   - Ø§Ù„ÙƒØ§Ø´ Ù…Ø¹ Ø§Ù„ØªØ§Ø¬Ø±: 400 Ø¬.Ù…                                    â”‚
â”‚   - Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© Ù„Ù„Ù…Ù†ØµØ©: 25.2 Ø¬.Ù…                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Online:                                                         â”‚
â”‚   - Ù…Ø¨ÙŠØ¹Ø§Øª ØµØ§ÙÙŠØ©: 270 Ø¬.Ù…                                       â”‚
â”‚   - Ø¹Ù…ÙˆÙ„Ø©: 270 Ã— 7% = 18.9 Ø¬.Ù…                                 â”‚
â”‚   - Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„ØªØ§Ø¬Ø±: (270 - 18.9) + 30 = 281.1 Ø¬.Ù…              â”‚
â”‚                     (ØµØ§ÙÙŠ + Ø±Ø³ÙˆÙ… ØªÙˆØµÙŠÙ„)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ø§Ù„Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:                                                â”‚
â”‚   Ù…Ø³ØªØ­Ù‚Ø§Øª Ù…Ù† Online: + 281.1 Ø¬.Ù…                               â”‚
â”‚   Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© Ù…Ù† COD:    - 25.2 Ø¬.Ù…                                â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”‚
â”‚   Ø§Ù„ØµØ§ÙÙŠ: + 255.9 Ø¬.Ù… (Ø§Ù„Ù…Ù†ØµØ© ØªØ¯ÙØ¹ Ù„Ù„ØªØ§Ø¬Ø±) âœ…                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 4: ØªØ§Ø¬Ø± ÙÙŠ ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ Ù…Ø¹ Online
```
Input:
- 8 Ø·Ù„Ø¨Ø§Øª Online
- Ù…Ø¨ÙŠØ¹Ø§Øª: 800 Ø¬.Ù…
- ØªÙˆØµÙŠÙ„: 80 Ø¬.Ù…
- Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 880 Ø¬.Ù…
- ÙØªØ±Ø© Ø³Ù…Ø§Ø­ Ù†Ø´Ø·Ø©

Expected:
- ÙˆØ¹Ø§Ø¡ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©: 800 Ø¬.Ù…
- Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù†Ø¸Ø±ÙŠØ©: 56 Ø¬.Ù… (7%)
- Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ©: 0 Ø¬.Ù… (ÙØªØ±Ø© Ø³Ù…Ø§Ø­)
- Ø§Ù„ÙƒØ§Ø´ Ù…Ø¹ Ø§Ù„Ù…Ù†ØµØ©: 880 Ø¬.Ù…
- Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„ØªØ§Ø¬Ø±: 800 + 80 = 880 Ø¬.Ù… (ÙƒØ§Ù…Ù„ Ø§Ù„Ù…Ø¨Ù„Øº!) âœ…
- ØªÙˆÙÙŠØ± ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­: 56 Ø¬.Ù… ğŸ
```

---

## 8. Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©

### âš ï¸ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª ØªÙ‚Ù†ÙŠØ©

1. **Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„**:
   - âŒ Ù„Ø§ ØªÙØ­Ø³Ø¨ Ø¶Ù…Ù† ÙˆØ¹Ø§Ø¡ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©
   - âœ… ØªÙØ¶Ø§Ù Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„ØªØ§Ø¬Ø± ÙÙŠ Ø­Ø§Ù„Ø© Online
   - âœ… ØªØ¨Ù‚Ù‰ Ù…Ø¹ Ø§Ù„ØªØ§Ø¬Ø± ÙÙŠ Ø­Ø§Ù„Ø© COD

2. **delivery_responsibility**:
   - Ø­Ø§Ù„ÙŠØ§Ù‹: `'merchant'` Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¬Ø§Ø±
   - Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹: ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ±Ù‡ Ù„Ù€ `'platform'` Ø¥Ø°Ø§ Ø£ØµØ¨Ø­Øª Ø§Ù„Ù…Ù†ØµØ© ØªÙˆØµÙ‘Ù„

3. **ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­**: ØªÙØ¹Ø±Ø¶ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù†Ø¸Ø±ÙŠØ© Ù…Ø¹ Ø®ØµÙ… 100% Ù„Ù„Ø´ÙØ§ÙÙŠØ©

4. **Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª**:
   - ØªÙØ·Ø¨Ù‚ ÙÙ‚Ø· Ø¨Ø¹Ø¯ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„
   - ØªÙØ®ØµÙ… Ù…Ù† ÙˆØ¹Ø§Ø¡ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© (Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ÙÙ‚Ø·)
   - âš ï¸ **Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ Ù„Ø§ ØªÙØ±Ø¯** Ù„Ù„Ø¹Ù…ÙŠÙ„ (Ø§Ù„Ø®Ø¯Ù…Ø© ØªÙ…Øª)
   - Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ ØªØ¨Ù‚Ù‰ Ù…Ø¹ Ø§Ù„ØªØ§Ø¬Ø± Ø­ØªÙ‰ Ù…Ø¹ Ø§Ù„Ù…Ø±ØªØ¬Ø¹ Ø§Ù„ÙƒØ§Ù…Ù„

5. **Ø§Ù„ØªØ³ÙˆÙŠØ©**: ØªÙØ­Ø³Ø¨ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ View ÙˆÙ„ÙŠØ³ Frontend logic

6. **Backward Compatibility**: Ø§Ù„ÙƒÙˆØ¯ ÙŠØ¯Ø¹Ù… `payment_method = 'cash'` Ùˆ `'cod'`

### ğŸ“Œ Ù‚Ø§Ø¹Ø¯Ø© Ø°Ù‡Ø¨ÙŠØ©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚   Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© = 7% Ã— (Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª - Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª - Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª)     â”‚
â”‚                                                                 â”‚
â”‚   Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ = 0% Ø¹Ù…ÙˆÙ„Ø© (Ø­Ù‚ ÙƒØ§Ù…Ù„ Ù„Ù„ØªØ§Ø¬Ø± Ø§Ù„Ù…ÙˆØµÙ‘Ù„)            â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØ³ÙˆÙŠØ© PDF

### 8.1 ØªØµÙ…ÙŠÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—    â”‚
â”‚   â•‘                         [LOGO Ø¥Ù†Ø¬Ø²Ù†Ø§]                             â•‘    â”‚
â”‚   â•‘                                                                   â•‘    â”‚
â”‚   â•‘                      ÙƒØ´Ù Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ³ÙˆÙŠØ©                            â•‘    â”‚
â”‚   â•‘                    Settlement Statement                          â•‘    â”‚
â”‚   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ©                           Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ø¬Ø±            â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚  Ø³ÙˆÙŠÙÙƒÙ… Ù„Ù„ØªØ¬Ø§Ø±Ø© ÙˆØ§Ù„ØªØµØ¯ÙŠØ± Ø°.Ù….Ù…          Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø±: Ù…Ø·Ø¹Ù… Ø§Ù„Ø¨Ø±ÙƒØ©   â”‚  â”‚
â”‚   â”‚  Ø³Ø¬Ù„ ØªØ¬Ø§Ø±ÙŠ: 2767                        Ø±Ù‚Ù… Ø§Ù„ØªØ§Ø¬Ø±: PRV-001      â”‚  â”‚
â”‚   â”‚  Ø¨Ù†ÙŠ Ø³ÙˆÙŠÙØŒ Ù…ØµØ±                          Ø§Ù„Ù‡Ø§ØªÙ: 01xxxxxxxxx      â”‚  â”‚
â”‚   â”‚  support@engezna.com                    Ø§Ù„Ø¨Ø±ÙŠØ¯: merchant@...     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  Ø±Ù‚Ù… Ø§Ù„ØªØ³ÙˆÙŠØ©: SET-2025-001234                                     â”‚  â”‚
â”‚   â”‚  Ø§Ù„ÙØªØ±Ø©: 20 Ø¯ÙŠØ³Ù…Ø¨Ø± 2025 - 25 Ø¯ÙŠØ³Ù…Ø¨Ø± 2025                          â”‚  â”‚
â”‚   â”‚  ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±: 26 Ø¯ÙŠØ³Ù…Ø¨Ø± 2025                                     â”‚  â”‚
â”‚   â”‚  Ø­Ø§Ù„Ø© Ø§Ù„ØªØ³ÙˆÙŠØ©: â³ Ù…Ø¹Ù„Ù‚Ø© / âœ… Ù…Ø³Ø¯Ø¯Ø©                                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                        ğŸ’µ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (COD)                   â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                             â”‚
â”‚   â”‚  Ø§Ù„Ø¨Ù†Ø¯                           â”‚     Ø§Ù„Ù…Ø¨Ù„Øº      â”‚   Ù…Ù„Ø§Ø­Ø¸Ø§Øª       â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚
â”‚   â”‚  Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª (12 Ø·Ù„Ø¨)        â”‚   1,500.00 Ø¬.Ù…  â”‚                 â”‚  â”‚
â”‚   â”‚  (-) Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„                â”‚    -150.00 Ø¬.Ù…  â”‚ ØºÙŠØ± Ø®Ø§Ø¶Ø¹Ø©       â”‚  â”‚
â”‚   â”‚  (-) Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶            â”‚     -50.00 Ø¬.Ù…  â”‚                 â”‚  â”‚
â”‚   â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚  â”‚
â”‚   â”‚  = ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª (ÙˆØ¹Ø§Ø¡ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©)  â”‚   1,300.00 Ø¬.Ù…  â”‚                 â”‚  â”‚
â”‚   â”‚                                  â”‚                 â”‚                 â”‚  â”‚
â”‚   â”‚  Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø© (7%)           â”‚      91.00 Ø¬.Ù…  â”‚                 â”‚  â”‚
â”‚   â”‚  (-) Ø®ØµÙ… ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ (100%)      â”‚     -91.00 Ø¬.Ù…  â”‚ ğŸ ØªÙˆÙÙŠØ±       â”‚  â”‚
â”‚   â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚  â”‚
â”‚   â”‚  = Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø³Ø¯Ø§Ø¯Ù‡Ø§        â”‚       0.00 Ø¬.Ù…  â”‚                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                        ğŸ’³ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Online)                  â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                             â”‚
â”‚   â”‚  Ø§Ù„Ø¨Ù†Ø¯                           â”‚     Ø§Ù„Ù…Ø¨Ù„Øº      â”‚   Ù…Ù„Ø§Ø­Ø¸Ø§Øª       â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚
â”‚   â”‚  Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ØµÙ‘Ù„ (3 Ø·Ù„Ø¨Ø§Øª)        â”‚     500.00 Ø¬.Ù…  â”‚                 â”‚  â”‚
â”‚   â”‚  (-) Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„                â”‚     -45.00 Ø¬.Ù…  â”‚ Ø­Ù‚Ùƒ ÙƒØ§Ù…Ù„Ø§Ù‹      â”‚  â”‚
â”‚   â”‚  (-) Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª                    â”‚       0.00 Ø¬.Ù…  â”‚                 â”‚  â”‚
â”‚   â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚  â”‚
â”‚   â”‚  = ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª                 â”‚     455.00 Ø¬.Ù…  â”‚                 â”‚  â”‚
â”‚   â”‚                                  â”‚                 â”‚                 â”‚  â”‚
â”‚   â”‚  (-) Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© (7%)                â”‚     -31.85 Ø¬.Ù…  â”‚                 â”‚  â”‚
â”‚   â”‚  (+) Ø®ØµÙ… ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ (100%)      â”‚     +31.85 Ø¬.Ù…  â”‚ ğŸ ØªÙˆÙÙŠØ±       â”‚  â”‚
â”‚   â”‚  (+) Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„                â”‚     +45.00 Ø¬.Ù…  â”‚ Ø­Ù‚Ùƒ            â”‚  â”‚
â”‚   â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚  â”‚
â”‚   â”‚  = Ù…Ø³ØªØ­Ù‚Ø§ØªÙƒ Ù„Ø¯Ù‰ Ø§Ù„Ù…Ù†ØµØ©           â”‚     500.00 Ø¬.Ù…  â”‚                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—    â”‚
â”‚   â•‘                       ğŸ“Š Ø§Ù„Ø®Ù„Ø§ØµØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©                         â•‘    â”‚
â”‚   â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£    â”‚
â”‚   â•‘                                                                   â•‘    â”‚
â”‚   â•‘   Ù…Ø³ØªØ­Ù‚Ø§ØªÙƒ Ù…Ù† Ø§Ù„Ù…Ù†ØµØ© (Online):           + 500.00 Ø¬.Ù…            â•‘    â”‚
â”‚   â•‘   Ù…Ø¯ÙŠÙˆÙ†ÙŠØªÙƒ Ù„Ù„Ù…Ù†ØµØ© (COD):                  - 0.00 Ø¬.Ù…             â•‘    â”‚
â”‚   â•‘   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â•‘    â”‚
â”‚   â•‘                                                                   â•‘    â”‚
â”‚   â•‘   ğŸ’° Ø§Ù„Ù…ÙŠØ²Ø§Ù† Ø§Ù„ØµØ§ÙÙŠ:                     + 500.00 Ø¬.Ù…            â•‘    â”‚
â”‚   â•‘   â¬…ï¸  Ø§Ù„Ù…Ù†ØµØ© Ø³ØªØ­ÙˆÙ„ Ù„Ùƒ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¨Ù„Øº                                  â•‘    â”‚
â”‚   â•‘                                                                   â•‘    â”‚
â”‚   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  ğŸ“ˆ Ù…Ù„Ø®Øµ ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­                                               â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚  Ø§Ù„Ø­Ø§Ù„Ø©: âœ… Ù†Ø´Ø·Ø©                                                    â”‚  â”‚
â”‚   â”‚  ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡: 15 Ù…Ø§Ø±Ø³ 2026                                       â”‚  â”‚
â”‚   â”‚  Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù†Ø¸Ø±ÙŠØ© Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©: 122.85 Ø¬.Ù…                            â”‚  â”‚
â”‚   â”‚  Ø§Ù„ØªÙˆÙÙŠØ± Ø§Ù„ÙØ¹Ù„ÙŠ (Ø®ØµÙ… 100%): 122.85 Ø¬.Ù… ğŸ                          â”‚  â”‚
â”‚   â”‚  Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙˆÙÙŠØ± Ù…Ù†Ø° Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©: 1,500.00 Ø¬.Ù…                          â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚   ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø´Ù…ÙˆÙ„Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ØªØ³ÙˆÙŠØ©: (15 Ø·Ù„Ø¨)                        â”‚
â”‚                                                                             â”‚
â”‚   â”‚ # Ø§Ù„Ø·Ù„Ø¨  â”‚ Ø§Ù„ØªØ§Ø±ÙŠØ®   â”‚ Ø§Ù„Ù…Ø¨Ù„Øº   â”‚ Ø§Ù„ØªÙˆØµÙŠÙ„ â”‚ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© â”‚ Ø§Ù„Ø­Ø§Ù„Ø© â”‚ Ø§Ù„Ø¯ÙØ¹  â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚
â”‚   â”‚ ORD-001  â”‚ 20/12     â”‚ 150 Ø¬    â”‚ 15 Ø¬    â”‚ 10.5 Ø¬  â”‚ âœ…     â”‚ COD    â”‚  â”‚
â”‚   â”‚ ORD-002  â”‚ 21/12     â”‚ 200 Ø¬    â”‚ 20 Ø¬    â”‚ 14.0 Ø¬  â”‚ âœ…     â”‚ Online â”‚  â”‚
â”‚   â”‚ ...      â”‚ ...       â”‚ ...      â”‚ ...     â”‚ ...     â”‚ ...    â”‚ ...    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚                                                                             â”‚
â”‚   ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª:                                                              â”‚
â”‚   â€¢ Ù‡Ø°Ø§ Ø§Ù„ÙƒØ´Ù ØµØ§Ø¯Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Ù‹ ÙˆÙ„Ø§ ÙŠØ­ØªØ§Ø¬ Ù„Ø®ØªÙ… Ø£Ùˆ ØªÙˆÙ‚ÙŠØ¹                      â”‚
â”‚   â€¢ Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª: support@engezna.com                                       â”‚
â”‚   â€¢ Ø±Ù‚Ù… Ø§Ù„Ø¯Ø¹Ù…: 01xxxxxxxxx                                                 â”‚
â”‚                                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚   ØµØ¯Ø± Ø¨ØªØ§Ø±ÙŠØ®: 26/12/2025 | Ø§Ù„ÙˆÙ‚Øª: 10:30 Øµ | Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¬Ø¹: REF-123456        â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 Ù…ØªØ·Ù„Ø¨Ø§Øª ØªÙ‚Ù†ÙŠØ© Ù„ØªÙ‚Ø±ÙŠØ± PDF

```typescript
// src/lib/pdf/settlement-report.ts

interface SettlementPDFConfig {
  // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ© (Ø«Ø§Ø¨ØªØ©)
  company: {
    name_ar: 'Ø³ÙˆÙŠÙÙƒÙ… Ù„Ù„ØªØ¬Ø§Ø±Ø© ÙˆØ§Ù„ØªØµØ¯ÙŠØ± Ø°.Ù….Ù…';
    name_en: 'Sweifcom for Trade and Export LLC';
    commercial_registry: '2767';
    address: 'Ø¨Ù†ÙŠ Ø³ÙˆÙŠÙØŒ Ù…ØµØ±';
    email: 'support@engezna.com';
    phone: '01xxxxxxxxx';
    logo_url: '/logo.svg';
  };

  // Ø§Ù„ØªØµÙ…ÙŠÙ…
  design: {
    primary_color: '#009DE0';  // Engezna Blue
    font_family: 'Noto Sans Arabic';
    rtl: true;
    page_size: 'A4';
    margin: '20mm';
  };

  // Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
  sections: [
    'header',           // Ø§Ù„Ø´Ø¹Ø§Ø± ÙˆØ¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ©
    'merchant_info',    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ø¬Ø±
    'settlement_meta',  // Ø±Ù‚Ù… Ø§Ù„ØªØ³ÙˆÙŠØ© ÙˆØ§Ù„ÙØªØ±Ø©
    'cod_breakdown',    // ØªÙØµÙŠÙ„ COD
    'online_breakdown', // ØªÙØµÙŠÙ„ Online
    'summary',          // Ø§Ù„Ø®Ù„Ø§ØµØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
    'grace_period',     // Ù…Ù„Ø®Øµ ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­
    'orders_table',     // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
    'footer'            // Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙˆØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±
  ];
}
```

### 8.3 Ù…ÙƒØªØ¨Ø© PDF Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©

```bash
# Ø§Ø³ØªØ®Ø¯Ø§Ù… react-pdf Ø£Ùˆ jspdf Ù…Ø¹ html2canvas
npm install @react-pdf/renderer

# Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… puppeteer Ù„Ù„ØªØ­ÙˆÙŠÙ„ Ù…Ù† HTML
npm install puppeteer
```

---

## 9. Ù…Ø¹Ø§ÙŠÙŠØ± Ù†Ø¬Ø§Ø­ Ø§Ù„ØªÙ†ÙÙŠØ°

### 9.1 Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù‚Ø¨ÙˆÙ„ (Acceptance Criteria)

| Ø§Ù„Ù…Ø¹ÙŠØ§Ø± | Ø§Ù„ÙˆØµÙ | Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ |
|---------|-------|--------------|
| **Ø¯Ù‚Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª** | Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙŠØ¯ÙˆÙŠ ÙˆØ§Ù„Ù†Ø¸Ø§Ù… = 0 | Ø§Ø®ØªØ¨Ø§Ø± 10 Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ù…Ø®ØªÙ„ÙØ© |
| **Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù€ View** | ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© < 500ms Ù„Ù€ 1000 Ø·Ù„Ø¨ | Query execution time |
| **ØªÙˆØ§ÙÙ‚ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª** | Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ Ø«Ø§Ø¨ØªØ© Ù…Ø¹ Ø£ÙŠ Ù…Ø±ØªØ¬Ø¹ | Ø§Ø®ØªØ¨Ø§Ø± Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª |
| **ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­** | Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© = 0 Ø®Ù„Ø§Ù„ Ø§Ù„Ù€ 6 Ø£Ø´Ù‡Ø± Ø§Ù„Ø£ÙˆÙ„Ù‰ | Ø§Ø®ØªØ¨Ø§Ø± ØªÙˆØ§Ø±ÙŠØ® Ù…Ø®ØªÙ„ÙØ© |
| **Ø«Ù†Ø§Ø¦ÙŠØ© Ø§Ù„Ù„ØºØ©** | Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØµÙˆØµ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© | Ù…Ø±Ø§Ø¬Ø¹Ø© ÙŠØ¯ÙˆÙŠØ© |
| **RTL Support** | Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ Ø§Ù„ØªØ®Ø·ÙŠØ· | Ø§Ø®ØªØ¨Ø§Ø± Ø¹Ù„Ù‰ Chrome/Safari |
| **ØªÙ‚Ø±ÙŠØ± PDF** | Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ | Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨ØµØ±ÙŠØ© |

### 9.2 Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©

| # | Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ | Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª | Ø§Ù„Ù…Ø®Ø±Ø¬ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ | Ø­Ø§Ù„Ø© |
|---|-----------|----------|----------------|------|
| 1 | COD + ÙØªØ±Ø© Ø³Ù…Ø§Ø­ | 900 Ø¬ Ù…Ø¨ÙŠØ¹Ø§Øª + 100 Ø¬ ØªÙˆØµÙŠÙ„ | Ù…Ø³ØªØ­Ù‚Ø§Øª = 1000 Ø¬ØŒ Ø¹Ù…ÙˆÙ„Ø© = 0 | â¬œ |
| 2 | Online + ÙØªØ±Ø© Ø³Ù…Ø§Ø­ | 450 Ø¬ Ù…Ø¨ÙŠØ¹Ø§Øª + 50 Ø¬ ØªÙˆØµÙŠÙ„ | Ù…Ø³ØªØ­Ù‚Ø§Øª = 500 Ø¬ØŒ Ø¹Ù…ÙˆÙ„Ø© = 0 | â¬œ |
| 3 | COD Ø¨Ø¯ÙˆÙ† ÙØªØ±Ø© Ø³Ù…Ø§Ø­ | 900 Ø¬ Ù…Ø¨ÙŠØ¹Ø§Øª + 100 Ø¬ ØªÙˆØµÙŠÙ„ | Ù…Ø¯ÙŠÙˆÙ†ÙŠØ© = 63 Ø¬ (7%) | â¬œ |
| 4 | Online Ø¨Ø¯ÙˆÙ† ÙØªØ±Ø© Ø³Ù…Ø§Ø­ | 450 Ø¬ Ù…Ø¨ÙŠØ¹Ø§Øª + 50 Ø¬ ØªÙˆØµÙŠÙ„ | Ù…Ø³ØªØ­Ù‚Ø§Øª = 468.5 Ø¬ | â¬œ |
| 5 | Ù…Ø±ØªØ¬Ø¹ ÙƒØ§Ù…Ù„ COD | 200 Ø¬ Ù…Ù†ØªØ¬ + 20 Ø¬ ØªÙˆØµÙŠÙ„ | ØªÙˆØµÙŠÙ„ = 20 Ø¬ (Ø«Ø§Ø¨Øª)ØŒ Ø¹Ù…ÙˆÙ„Ø© = 0 | â¬œ |
| 6 | Ù…Ø±ØªØ¬Ø¹ ÙƒØ§Ù…Ù„ Online | 200 Ø¬ Ù…Ù†ØªØ¬ + 20 Ø¬ ØªÙˆØµÙŠÙ„ | Ù…Ø³ØªØ­Ù‚Ø§Øª = 20 Ø¬ (ØªÙˆØµÙŠÙ„ ÙÙ‚Ø·) | â¬œ |
| 7 | Ù…Ø±ØªØ¬Ø¹ Ø¬Ø²Ø¦ÙŠ 50% | 500 Ø¬ + 30 Ø¬ ØªÙˆØµÙŠÙ„ | Ø¹Ù…ÙˆÙ„Ø© Ø¹Ù„Ù‰ 250 Ø¬ + 30 Ø¬ ØªÙˆØµÙŠÙ„ | â¬œ |
| 8 | Ù…Ø²ÙŠØ¬ COD + Online | Ù…ØªØ¹Ø¯Ø¯ | Ø§Ù„Ù…ÙŠØ²Ø§Ù† ØµØ­ÙŠØ­ | â¬œ |
| 9 | Ø§Ù†ØªÙ‡Ø§Ø¡ ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ | ØªØ§Ø¬Ø± Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ÙØªØ±Ø© | Ø¹Ù…ÙˆÙ„Ø© 7% | â¬œ |
| 10 | ØªÙ‚Ø±ÙŠØ± PDF | Ø£ÙŠ ØªØ³ÙˆÙŠØ© | PDF Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù„ØªØµÙ…ÙŠÙ… | â¬œ |

### 9.3 Ù…Ù‚Ø§ÙŠÙŠØ³ Ø§Ù„Ø£Ø¯Ø§Ø¡ (KPIs)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Ù…Ù‚Ø§ÙŠÙŠØ³ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ğŸ“Š ÙˆÙ‚Øª ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©                                                  â”‚
â”‚   â”œâ”€â”€ Provider Finance Page: < 2 Ø«Ø§Ù†ÙŠØ©                                 â”‚
â”‚   â”œâ”€â”€ Admin Settlements Page: < 3 Ø«ÙˆØ§Ù†ÙŠ                                â”‚
â”‚   â””â”€â”€ Settlement Detail Page: < 2 Ø«Ø§Ù†ÙŠØ©                                â”‚
â”‚                                                                         â”‚
â”‚   âš¡ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª                                                   â”‚
â”‚   â”œâ”€â”€ financial_settlement_engine View: < 500ms                        â”‚
â”‚   â”œâ”€â”€ Settlement generation (single): < 1 Ø«Ø§Ù†ÙŠØ©                        â”‚
â”‚   â””â”€â”€ Bulk settlement generation: < 10 Ø«ÙˆØ§Ù†ÙŠ Ù„Ù€ 100 ØªØ§Ø¬Ø±               â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“„ ØªÙ‚Ø±ÙŠØ± PDF                                                          â”‚
â”‚   â”œâ”€â”€ ÙˆÙ‚Øª Ø§Ù„ØªÙˆÙ„ÙŠØ¯: < 3 Ø«ÙˆØ§Ù†ÙŠ                                           â”‚
â”‚   â””â”€â”€ Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù: < 500 KB                                               â”‚
â”‚                                                                         â”‚
â”‚   âœ… Ø¯Ù‚Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª                                                       â”‚
â”‚   â”œâ”€â”€ Ù†Ø³Ø¨Ø© Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„Ø©: 0%                                           â”‚
â”‚   â””â”€â”€ ØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙŠØ¯ÙˆÙŠ: 100%                                      â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.4 Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©

#### Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø·Ù„Ø§Ù‚:
- [ ] Ø§Ø®ØªØ¨Ø§Ø± View Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠØ©
- [ ] Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª (Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ Ø«Ø§Ø¨ØªØ©)
- [ ] Ø§Ø®ØªØ¨Ø§Ø± Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ©
- [ ] Ø§Ø®ØªØ¨Ø§Ø± Partial Refund
- [ ] Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
- [ ] Ø§Ø®ØªØ¨Ø§Ø± RTL layout
- [ ] Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª AR/EN
- [ ] Ø§Ø®ØªØ¨Ø§Ø± ØªÙ‚Ø±ÙŠØ± PDF (ØªØµÙ…ÙŠÙ… + Ù…Ø­ØªÙˆÙ‰)
- [ ] Ø§Ø®ØªØ¨Ø§Ø± Ø£Ø¯Ø§Ø¡ Ø§Ù„ØµÙØ­Ø§Øª
- [ ] Ù…Ø±Ø§Ø¬Ø¹Ø© Security (RLS policies)

#### Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø·Ù„Ø§Ù‚:
- [ ] Ù…Ø±Ø§Ù‚Ø¨Ø© Supabase logs Ù„Ø£Ø®Ø·Ø§Ø¡
- [ ] Ø¬Ù…Ø¹ feedback Ù…Ù† Ø£ÙˆÙ„ 5 ØªØ¬Ø§Ø±
- [ ] Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¯Ù‚Ø© Ø£ÙˆÙ„ 10 ØªØ³ÙˆÙŠØ§Øª
- [ ] Ù…Ø±Ø§Ø¬Ø¹Ø© ØªÙ‚Ø§Ø±ÙŠØ± PDF Ø§Ù„Ù…ÙˆÙ„Ø¯Ø©

---

## 10. Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø®ØªØ§Ù…ÙŠØ©

### ğŸ“Œ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                         â”‚
â”‚   1ï¸âƒ£  Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© = 7% Ã— (Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª - Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª - Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª)         â”‚
â”‚                                                                         â”‚
â”‚   2ï¸âƒ£  Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ = 0% Ø¹Ù…ÙˆÙ„Ø© (Ø­Ù‚ ÙƒØ§Ù…Ù„ Ù„Ù„ØªØ§Ø¬Ø±)                        â”‚
â”‚                                                                         â”‚
â”‚   3ï¸âƒ£  Ø§Ù„Ù…Ø±ØªØ¬Ø¹ Ù„Ø§ ÙŠØ´Ù…Ù„ Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ (Ø§Ù„Ø®Ø¯Ù…Ø© ØªÙ…Øª)                        â”‚
â”‚                                                                         â”‚
â”‚   4ï¸âƒ£  ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ = Ø¹Ù…ÙˆÙ„Ø© 0% Ù„Ø£ÙˆÙ„ 6 Ø£Ø´Ù‡Ø±                              â”‚
â”‚                                                                         â”‚
â”‚   5ï¸âƒ£  Ø§Ù„Ø´ÙØ§ÙÙŠØ© = Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„Ù†Ø¸Ø±ÙŠØ© Ø­ØªÙ‰ Ù…Ø¹ Ø§Ù„Ø®ØµÙ…                   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…ØªØ£Ø«Ø±Ø©

| Ø§Ù„Ù…Ù„Ù | Ù†ÙˆØ¹ Ø§Ù„ØªØºÙŠÙŠØ± |
|-------|-------------|
| `supabase/migrations/xxx_financial_engine.sql` | Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙŠØ¯ |
| `src/app/[locale]/provider/finance/page.tsx` | ØªØ­Ø¯ÙŠØ« ÙƒØ¨ÙŠØ± |
| `src/app/[locale]/provider/analytics/page.tsx` | ØªØ­Ø¯ÙŠØ« |
| `src/app/[locale]/admin/settlements/page.tsx` | ØªØ­Ø¯ÙŠØ« ÙƒØ¨ÙŠØ± |
| `src/app/[locale]/admin/settlements/[id]/page.tsx` | ØªØ­Ø¯ÙŠØ« |
| `src/components/provider/finance/QuickStatsCards.tsx` | Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙŠØ¯ |
| `src/components/provider/finance/SettlementBreakdown.tsx` | Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙŠØ¯ |
| `src/components/admin/finance/AdminFinanceStats.tsx` | Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙŠØ¯ |
| `src/lib/pdf/settlement-report.ts` | Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙŠØ¯ |
| `src/i18n/messages/ar.json` | ØªØ­Ø¯ÙŠØ« |
| `src/i18n/messages/en.json` | ØªØ­Ø¯ÙŠØ« |

---

**ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø© Ø¨ÙˆØ§Ø³Ø·Ø©**: Claude Code
**Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ù†**: Mosab Ragab
**Ø§Ù„Ø¥ØµØ¯Ø§Ø±**: 2.2 (Ù†Ù‡Ø§Ø¦ÙŠ)
**Ø§Ù„Ø­Ø§Ù„Ø©**: Ù…Ø¹ØªÙ…Ø¯Ø© Ù„Ù„ØªÙ†ÙÙŠØ° âœ…
**ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯**: 25 Ø¯ÙŠØ³Ù…Ø¨Ø± 2025
